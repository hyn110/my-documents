<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>docker讲义.md</title><link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}.CodeMirror { height: auto; }
.CodeMirror-scroll { overflow-y: hidden; overflow-x: auto; }
.CodeMirror-lines { padding: 4px 0px; }
.CodeMirror pre { }
.CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler { background-color: white; }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); background-color: rgb(247, 247, 247); white-space: nowrap; }
.CodeMirror-linenumbers { }
.CodeMirror-linenumber { padding: 0px 3px 0px 5px; text-align: right; color: rgb(153, 153, 153); }
.CodeMirror div.CodeMirror-cursor { border-left: 1px solid black; z-index: 3; }
.CodeMirror div.CodeMirror-secondarycursor { border-left: 1px solid silver; }
.CodeMirror.cm-keymap-fat-cursor div.CodeMirror-cursor { width: auto; border: 0px; background: rgb(119, 238, 119); z-index: 1; }
.CodeMirror div.CodeMirror-cursor.CodeMirror-overwrite { }
.cm-tab { display: inline-block; }
.cm-s-typora-default .cm-header, .cm-s-typora-default .cm-property { color: rgb(217, 79, 138); }
.cm-s-typora-default pre.cm-header1:not(.cm-atom) :not(.cm-overlay) { font-size: 2rem; line-height: 2rem; }
.cm-s-typora-default pre.cm-header2:not(.cm-atom) :not(.cm-overlay) { font-size: 1.4rem; line-height: 1.4rem; }
.cm-s-typora-default .cm-atom, .cm-s-typora-default .cm-number { color: rgb(149, 132, 134); }
.cm-s-typora-default .cm-table-row, .cm-s-typora-default .cm-block-start { font-family: monospace; }
.cm-s-typora-default .cm-comment, .cm-s-typora-default .cm-code { color: rgb(74, 90, 159); font-family: monospace; }
.cm-s-typora-default .cm-tag { color: rgb(169, 68, 66); }
.cm-s-typora-default .cm-string { color: rgb(126, 134, 169); }
.cm-s-typora-default .cm-link { color: rgb(196, 122, 15); text-decoration: underline; }
.cm-s-typora-default .cm-variable-2, .cm-s-typora-default .cm-variable-1 { color: inherit; }
.cm-s-typora-default .cm-overlay { font-size: 1rem; font-family: monospace; }
.CodeMirror.cm-s-typora-default div.CodeMirror-cursor { border-left: 3px solid rgb(228, 98, 154); }
.cm-s-typora-default .CodeMirror-activeline-background { left: -60px; right: -30px; background: rgba(204, 204, 204, 0.2); }
.cm-s-typora-default .CodeMirror-gutters { border-right: none; background-color: inherit; }
.cm-s-typora-default .cm-trailing-space-new-line::after, .cm-startspace::after, .cm-starttab .cm-tab::after { content: "•"; position: absolute; left: 0px; opacity: 0; font-family: LetterGothicStd, monospace; }
.os-windows .cm-startspace::after, .os-windows .cm-starttab .cm-tab::after { left: -0.1em; }
.cm-starttab .cm-tab::after { content: " "; }
.cm-startspace, .cm-tab, .cm-starttab, .cm-trailing-space-a, .cm-trailing-space-b, .cm-trailing-space-new-line { font-family: monospace; position: relative; }
.cm-s-typora-default .cm-trailing-space-new-line::after { content: "↓"; opacity: 0.3; }
.cm-s-inner .cm-keyword { color: rgb(119, 0, 136); }
.cm-s-inner .cm-atom, .cm-s-inner.cm-atom { color: rgb(34, 17, 153); }
.cm-s-inner .cm-number { color: rgb(17, 102, 68); }
.cm-s-inner .cm-def { color: rgb(0, 0, 255); }
.cm-s-inner .cm-variable { color: black; }
.cm-s-inner .cm-variable-2 { color: rgb(0, 85, 170); }
.cm-s-inner .cm-variable-3 { color: rgb(0, 136, 85); }
.cm-s-inner .cm-property { color: black; }
.cm-s-inner .cm-operator { color: rgb(152, 26, 26); }
.cm-s-inner .cm-comment, .cm-s-inner.cm-comment { color: rgb(170, 85, 0); }
.cm-s-inner .cm-string { color: rgb(170, 17, 17); }
.cm-s-inner .cm-string-2 { color: rgb(255, 85, 0); }
.cm-s-inner .cm-meta { color: rgb(85, 85, 85); }
.cm-s-inner .cm-qualifier { color: rgb(85, 85, 85); }
.cm-s-inner .cm-builtin { color: rgb(51, 0, 170); }
.cm-s-inner .cm-bracket { color: rgb(153, 153, 119); }
.cm-s-inner .cm-tag { color: rgb(17, 119, 0); }
.cm-s-inner .cm-attribute { color: rgb(0, 0, 204); }
.cm-s-inner .cm-header, .cm-s-inner.cm-header { color: blue; }
.cm-s-inner .cm-quote, .cm-s-inner.cm-quote { color: rgb(0, 153, 0); }
.cm-s-inner .cm-hr, .cm-s-inner.cm-hr { color: rgb(153, 153, 153); }
.cm-s-inner .cm-link, .cm-s-inner.cm-link { color: rgb(0, 0, 204); }
.cm-negative { color: rgb(221, 68, 68); }
.cm-positive { color: rgb(34, 153, 34); }
.cm-header, .cm-strong { font-weight: bold; }
.cm-del { text-decoration: line-through; }
.cm-em { font-style: italic; }
.cm-link { text-decoration: underline; }
.cm-error { color: rgb(255, 0, 0); }
.cm-invalidchar { color: rgb(255, 0, 0); }
.cm-constant { color: rgb(38, 139, 210); }
.cm-defined { color: rgb(181, 137, 0); }
div.CodeMirror span.CodeMirror-matchingbracket { color: rgb(0, 255, 0); }
div.CodeMirror span.CodeMirror-nonmatchingbracket { color: rgb(255, 34, 34); }
.cm-s-inner .CodeMirror-activeline-background { background: inherit; }
.CodeMirror { position: relative; overflow: hidden; }
.CodeMirror-scroll { margin-bottom: -30px; margin-right: -30px; padding-bottom: 30px; padding-right: 30px; height: 100%; outline: none; position: relative; box-sizing: content-box; }
.CodeMirror-sizer { position: relative; }
.CodeMirror-vscrollbar, .CodeMirror-hscrollbar, .CodeMirror-scrollbar-filler, .CodeMirror-gutter-filler { position: absolute; z-index: 6; display: none; }
.CodeMirror-vscrollbar { right: 0px; top: 0px; overflow-x: hidden; overflow-y: scroll; }
.CodeMirror-hscrollbar { bottom: 0px; left: 0px; overflow-y: hidden; overflow-x: scroll; }
.CodeMirror-scrollbar-filler { right: 0px; bottom: 0px; }
.CodeMirror-gutter-filler { left: 0px; bottom: 0px; }
.CodeMirror-gutters { position: absolute; left: 0px; top: 0px; padding-bottom: 30px; z-index: 3; }
.CodeMirror-gutter { white-space: normal; height: 100%; box-sizing: content-box; padding-bottom: 30px; margin-bottom: -32px; display: inline-block; }
.CodeMirror-gutter-elt { position: absolute; cursor: default; z-index: 4; }
.CodeMirror-lines { cursor: text; }
.CodeMirror pre { border-radius: 0px; border-width: 0px; background: transparent; font-family: inherit; font-size: inherit; margin: 0px; white-space: pre; word-wrap: normal; color: inherit; z-index: 2; position: relative; overflow: visible; }
.CodeMirror-wrap pre { word-wrap: break-word; white-space: pre-wrap; word-break: normal; }
.CodeMirror-code pre { border-right: 30px solid transparent; width: fit-content; }
.CodeMirror-wrap .CodeMirror-code pre { border-right: none; width: auto; }
.CodeMirror-linebackground { position: absolute; left: 0px; right: 0px; top: 0px; bottom: 0px; z-index: 0; }
.CodeMirror-linewidget { position: relative; z-index: 2; overflow: auto; }
.CodeMirror-widget { }
.CodeMirror-wrap .CodeMirror-scroll { overflow-x: hidden; }
.CodeMirror-measure { position: absolute; width: 100%; height: 0px; overflow: hidden; visibility: hidden; }
.CodeMirror-measure pre { position: static; }
.CodeMirror div.CodeMirror-cursor { position: absolute; visibility: hidden; border-right: none; width: 0px; }
.CodeMirror div.CodeMirror-cursor { visibility: hidden; }
.CodeMirror-focused div.CodeMirror-cursor { visibility: inherit; }
.CodeMirror-selected { background: rgb(217, 217, 217); }
.CodeMirror-focused .CodeMirror-selected { background: rgb(215, 212, 240); }
.cm-searching { background: rgba(255, 255, 0, 0.4); }
.CodeMirror span { }
@media print {
  .CodeMirror div.CodeMirror-cursor { visibility: hidden; }
}
.CodeMirror-lint-markers { width: 16px; }
.CodeMirror-lint-tooltip { background-color: infobackground; border: 1px solid black; border-radius: 4px; color: infotext; font-family: monospace; overflow: hidden; padding: 2px 5px; position: fixed; white-space: pre-wrap; z-index: 10000; max-width: 600px; opacity: 0; transition: opacity 0.4s; font-size: 0.8em; }
.CodeMirror-lint-mark-error, .CodeMirror-lint-mark-warning { background-position: left bottom; background-repeat: repeat-x; }
.CodeMirror-lint-mark-error { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAADCAYAAAC09K7GAAAAAXNSR0IArs4c6QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB9sJDw4cOCW1/KIAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAHElEQVQI12NggIL/DAz/GdA5/xkY/qPKMDAwAADLZwf5rvm+LQAAAABJRU5ErkJggg=="); }
.CodeMirror-lint-marker-error, .CodeMirror-lint-marker-warning { background-position: center center; background-repeat: no-repeat; cursor: pointer; display: inline-block; height: 16px; width: 16px; vertical-align: middle; position: relative; }
.CodeMirror-lint-message-error, .CodeMirror-lint-message-warning { padding-left: 18px; background-position: left top; background-repeat: no-repeat; }
.CodeMirror-lint-marker-error, .CodeMirror-lint-message-error { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAHlBMVEW7AAC7AACxAAC7AAC7AAAAAAC4AAC5AAD///+7AAAUdclpAAAABnRSTlMXnORSiwCK0ZKSAAAATUlEQVR42mWPOQ7AQAgDuQLx/z8csYRmPRIFIwRGnosRrpamvkKi0FTIiMASR3hhKW+hAN6/tIWhu9PDWiTGNEkTtIOucA5Oyr9ckPgAWm0GPBog6v4AAAAASUVORK5CYII="); }
.CodeMirror-lint-marker-warning, .CodeMirror-lint-message-warning { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAANlBMVEX/uwDvrwD/uwD/uwD/uwD/uwD/uwD/uwD/uwD6twD/uwAAAADurwD2tQD7uAD+ugAAAAD/uwDhmeTRAAAADHRSTlMJ8mN1EYcbmiixgACm7WbuAAAAVklEQVR42n3PUQqAIBBFUU1LLc3u/jdbOJoW1P08DA9Gba8+YWJ6gNJoNYIBzAA2chBth5kLmG9YUoG0NHAUwFXwO9LuBQL1giCQb8gC9Oro2vp5rncCIY8L8uEx5ZkAAAAASUVORK5CYII="); }
.CodeMirror-lint-marker-multiple { background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAHCAMAAADzjKfhAAAACVBMVEUAAAAAAAC/v7914kyHAAAAAXRSTlMAQObYZgAAACNJREFUeNo1ioEJAAAIwmz/H90iFFSGJgFMe3gaLZ0od+9/AQZ0ADosbYraAAAAAElFTkSuQmCC"); background-repeat: no-repeat; background-position: right bottom; width: 100%; height: 100%; }


html { font-size: 14px; background-color: rgb(255, 255, 255); color: rgb(51, 51, 51); }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 1rem; line-height: 1.42857; overflow-x: hidden; background: inherit; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { background: rgb(181, 214, 252); text-shadow: none; }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; padding-bottom: 70px; white-space: pre-wrap; overflow-x: visible; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
@media screen and (max-width: 500px) {
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
.typora-export #write { margin: 0px auto; }
#write > p:first-child, #write > ul:first-child, #write > ol:first-child, #write > pre:first-child, #write > blockquote:first-child, #write > div:first-child, #write > table:first-child { margin-top: 30px; }
#write li > table:first-child { margin-top: -20px; }
img { max-width: 100%; vertical-align: middle; }
input, button, select, textarea { color: inherit; font-style: inherit; font-variant: inherit; font-weight: inherit; font-stretch: inherit; font-size: inherit; line-height: inherit; font-family: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
::before, ::after, * { box-sizing: border-box; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write div, #write pre { width: inherit; }
#write p, #write h1, #write h2, #write h3, #write h4, #write h5, #write h6 { position: relative; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
p { -webkit-margin-before: 1rem; -webkit-margin-after: 1rem; -webkit-margin-start: 0px; -webkit-margin-end: 0px; }
.mathjax-block { margin-top: 0px; margin-bottom: 0px; -webkit-margin-before: 0rem; -webkit-margin-after: 0rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: bold; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.701961); color: rgb(85, 85, 85); border-radius: 4px; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; margin: 4px 0px 0px; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 80px; }
.CodeMirror-gutters { border-right: 0px; background-color: inherit; }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
pre { white-space: pre-wrap; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background: inherit; position: relative !important; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
.md-fences .CodeMirror.CodeMirror-wrap { top: -1.6em; margin-bottom: -1.6em; }
.md-fences.mock-cm { white-space: pre-wrap; }
.show-fences-line-number .md-fences { padding-left: 0px; }
.show-fences-line-number .md-fences.mock-cm { padding-left: 40px; }
.footnotes { opacity: 0.8; font-size: 0.9rem; padding-top: 1em; padding-bottom: 1em; }
.footnotes + .footnotes { margin-top: -1em; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; background: transparent; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; -webkit-tap-highlight-color: transparent; line-height: normal; font-weight: normal; text-align: left; box-sizing: content-box; direction: ltr; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li p, li .mathjax-block { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; }
@media print {
  html, body { height: 100%; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  h1, h2, h3, h4, h5, h6 { break-after: avoid-page; orphans: 2; }
  p { orphans: 4; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 1cm; padding-right: 1cm; }
  .typora-export #write::after { height: 0px; }
  @page { margin: 20mm 0mm; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 2.86rem; white-space: pre-wrap; background: rgb(204, 204, 204); display: block; overflow-x: hidden; }
p .md-image:only-child { display: inline-block; width: 100%; text-align: center; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.mathjax-block { white-space: pre; overflow: hidden; width: 100%; }
p + .mathjax-block { margin-top: -1.143rem; }
.mathjax-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus { outline: none; box-shadow: none; }
.task-list { list-style-type: none; }
.task-list-item { position: relative; padding-left: 1em; }
.task-list-item input { position: absolute; top: 0px; left: 0px; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc::after, .md-toc-content::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); text-decoration: none; }
.md-toc-inner:hover { }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: bold; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) {
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
.md-tag { opacity: 0.5; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: monospace; }
code { text-align: left; }
h1 .md-tag, h2 .md-tag, h3 .md-tag, h4 .md-tag, h5 .md-tag, h6 .md-tag { font-weight: initial; opacity: 0.35; }
a.md-print-anchor { border-width: initial !important; border-style: none !important; border-color: initial !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: none !important; background: transparent !important; text-decoration: initial !important; text-shadow: initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.mathjax-block .MathJax_SVG_Display { text-align: center; margin: 1em 0em; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: monospace; }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: normal; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }


@font-face { font-family: "Open Sans"; font-style: normal; font-weight: normal; src: local("Open Sans Regular"), url("./github/400.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: italic; font-weight: normal; src: local("Open Sans Italic"), url("./github/400i.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: normal; font-weight: bold; src: local("Open Sans Bold"), url("./github/700.woff") format("woff"); }
@font-face { font-family: "Open Sans"; font-style: italic; font-weight: bold; src: local("Open Sans Bold Italic"), url("./github/700i.woff") format("woff"); }
html { font-size: 16px; }
body { font-family: "Open Sans", "Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif; color: rgb(51, 51, 51); line-height: 1.6; }
#write { max-width: 860px; margin: 0px auto; padding: 20px 30px 100px; }
#write > ul:first-child, #write > ol:first-child { margin-top: 30px; }
body > :first-child { margin-top: 0px !important; }
body > :last-child { margin-bottom: 0px !important; }
a { color: rgb(65, 131, 196); }
h1, h2, h3, h4, h5, h6 { position: relative; margin-top: 1rem; margin-bottom: 1rem; font-weight: bold; line-height: 1.4; cursor: text; }
h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor { text-decoration: none; }
h1 tt, h1 code { font-size: inherit; }
h2 tt, h2 code { font-size: inherit; }
h3 tt, h3 code { font-size: inherit; }
h4 tt, h4 code { font-size: inherit; }
h5 tt, h5 code { font-size: inherit; }
h6 tt, h6 code { font-size: inherit; }
h1 { padding-bottom: 0.3em; font-size: 2.25em; line-height: 1.2; border-bottom: 1px solid rgb(238, 238, 238); }
h2 { padding-bottom: 0.3em; font-size: 1.75em; line-height: 1.225; border-bottom: 1px solid rgb(238, 238, 238); }
h3 { font-size: 1.5em; line-height: 1.43; }
h4 { font-size: 1.25em; }
h5 { font-size: 1em; }
h6 { font-size: 1em; color: rgb(119, 119, 119); }
p, blockquote, ul, ol, dl, table { margin: 0.8em 0px; }
li > ol, li > ul { margin: 0px; }
hr { height: 4px; padding: 0px; margin: 16px 0px; background-color: rgb(231, 231, 231); border-width: 0px 0px 1px; border-style: none none solid; border-top-color: initial; border-right-color: initial; border-left-color: initial; border-image: initial; overflow: hidden; box-sizing: content-box; border-bottom-color: rgb(221, 221, 221); }
body > h2:first-child { margin-top: 0px; padding-top: 0px; }
body > h1:first-child { margin-top: 0px; padding-top: 0px; }
body > h1:first-child + h2 { margin-top: 0px; padding-top: 0px; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child { margin-top: 0px; padding-top: 0px; }
a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 { margin-top: 0px; padding-top: 0px; }
h1 p, h2 p, h3 p, h4 p, h5 p, h6 p { margin-top: 0px; }
li p.first { display: inline-block; }
ul, ol { padding-left: 30px; }
ul:first-child, ol:first-child { margin-top: 0px; }
ul:last-child, ol:last-child { margin-bottom: 0px; }
blockquote { border-left: 4px solid rgb(221, 221, 221); padding: 0px 15px; color: rgb(119, 119, 119); }
blockquote blockquote { padding-right: 0px; }
table { padding: 0px; word-break: initial; }
#write { overflow-x: auto; }
table tr { border-top: 1px solid rgb(204, 204, 204); background-color: white; margin: 0px; padding: 0px; }
table tr:nth-child(2n) { background-color: rgb(248, 248, 248); }
table tr th { font-weight: bold; border: 1px solid rgb(204, 204, 204); text-align: left; margin: 0px; padding: 6px 13px; }
table tr td { border: 1px solid rgb(204, 204, 204); text-align: left; margin: 0px; padding: 6px 13px; }
table tr th:first-child, table tr td:first-child { margin-top: 0px; }
table tr th:last-child, table tr td:last-child { margin-bottom: 0px; }
.CodeMirror-gutters { border-right: 1px solid rgb(221, 221, 221); }
.md-fences, code, tt { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); border-radius: 3px; font-family: Consolas, "Liberation Mono", Courier, monospace; padding: 2px 4px 0px; font-size: 0.9em; }
.md-fences { margin-bottom: 15px; margin-top: 15px; padding: 8px 1em 6px; }
.task-list { padding-left: 0px; }
.task-list-item { padding-left: 32px; }
.task-list-item input { top: 3px; left: 8px; }
@media screen and (min-width: 914px) {
}
@media print {
  html { font-size: 13px; }
  table, pre { break-inside: avoid; }
  pre { word-wrap: break-word; }
}
.md-fences { background-color: rgb(248, 248, 248); }
#write pre.md-meta-block { padding: 1rem; font-size: 85%; line-height: 1.45; background-color: rgb(247, 247, 247); border: 0px; border-radius: 3px; color: rgb(119, 119, 119); margin-top: 0px !important; }
.mathjax-block > .code-tooltip { bottom: 0.375rem; }
#write > h3.md-focus::before { left: -1.5625rem; top: 0.375rem; }
#write > h4.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h5.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
#write > h6.md-focus::before { left: -1.5625rem; top: 0.285714rem; }
.md-image > .md-meta { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); border-radius: 3px; font-family: Consolas, "Liberation Mono", Courier, monospace; padding: 2px 4px 0px; font-size: 0.9em; color: inherit; }
.md-tag { color: inherit; }
.md-toc { margin-top: 20px; padding-bottom: 20px; }
#typora-quick-open { border: 1px solid rgb(221, 221, 221); background-color: rgb(248, 248, 248); }
#typora-quick-open-item { background-color: rgb(250, 250, 250); border-color: rgb(254, 254, 254) rgb(229, 229, 229) rgb(229, 229, 229) rgb(238, 238, 238); border-style: solid; border-width: 1px; }
#md-notification::before { top: 10px; }
.on-focus-mode blockquote { border-left-color: rgba(85, 85, 85, 0.117647); }
header, .context-menu, .megamenu-content, footer { font-family: "Segoe UI", Arial, sans-serif; }






</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-node'><p></p><h1><a name='header-n3' class='md-header-anchor '></a>docker讲义</h1><h2><a name='header-n4' class='md-header-anchor '></a>1 下载docker镜像</h2><ul><li>Win10:直接使用安装包安装,下载地址:<a href='https://download.docker.com/win/stable/InstallDocker.msi'>Docker v17.06</a></li><li>非win10系统使用Docker Toolbox安装,下载地址:<a href='http://10.0.0.149/DockerToolbox.exe?fid=VaNGfiqDVLzpPJiAtHNf3GjQKZIAYNwMAAAAANpDYuku0ZUKxSgqgFkbR2cVYM6z&mid=666&threshold=150&tid=7EE15FC354C06D08F131458B7A8FFF8F&srcid=119&verno=1'>DockerToolbox</a></li><li>centOS 下载地址 : <a href='https://download.docker.com/linux/centos/7/x86_64/stable/Packages/'>rpm包下载</a></li></ul><p></p><h2><a name='header-n18' class='md-header-anchor '></a>2 windows下安装docker</h2><ul><li><p><strong>系统要求:</strong></p><ul><li>64位系统,系统版本不能低于win7</li><li>开启虚拟化技术(需要在bios中设置,通常情况下都是开启的)</li></ul></li><li><p><strong>安装(win7下)</strong></p><ol start='' ><li><p>双击运行DockerToolbox</p><p><img src='https://docs.docker.com/toolbox/images/installer_open.png' alt='' /></p></li><li><p>设置好安装目录,然后确认</p></li><li><p>在后续弹出的对话框,全部选择确认即可</p><blockquote><p>安装过程中会提示程序需要修改环境变量,或者安装一些驱动时,需要全部选择确认</p></blockquote></li></ol></li><li><p><strong>验证安装</strong></p><ul><li><p>运行客户终端 <code>Docker QuickStart Terminal</code>,当出现<code>$</code>时,说明程序初始化完成</p><p><img src='https://docs.docker.com/toolbox/images/b2d_shell.png' alt='客户终端初始化完成' /></p></li><li><p>输入指令 <code>docker run hello-world</code> ,并回车,当程序能正确运行后,控制台可以看到如下的类似信息</p><pre class="md-fences md-end-block" lang="powershell"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><span><span>​</span>x</span></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-error">$</span> <span class="cm-identifier">docker</span> <span class="cm-identifier">run</span> <span class="cm-identifier">hello-world</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-identifier">Unable</span> <span class="cm-identifier">to</span> <span class="cm-identifier">find</span> <span class="cm-identifier">image</span> <span class="cm-string">'hello-world:latest'</span> <span class="cm-identifier">locally</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-identifier">Pulling</span> <span class="cm-identifier">repository</span> <span class="cm-identifier">hello-world</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-number">91</span><span class="cm-identifier">c95931e552</span><span class="cm-operator">:</span> <span class="cm-identifier">Download</span> <span class="cm-identifier">complete</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-identifier">a8219747be10</span><span class="cm-operator">:</span> <span class="cm-identifier">Download</span> <span class="cm-identifier">complete</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-identifier">Status</span><span class="cm-operator">:</span> <span class="cm-identifier">Downloaded</span> <span class="cm-identifier">newer</span> <span class="cm-identifier">image</span> <span class="cm-keyword">for</span> <span class="cm-identifier">hello-world</span><span class="cm-operator">:</span><span class="cm-identifier">latest</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-identifier">Hello</span> <span class="cm-keyword">from</span> <span class="cm-identifier">Docker</span><span class="cm-punctuation">.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-identifier">This</span> <span class="cm-identifier">message</span> <span class="cm-identifier">shows</span> <span class="cm-identifier">that</span> <span class="cm-identifier">your</span> <span class="cm-identifier">installation</span> <span class="cm-identifier">appears</span> <span class="cm-identifier">to</span> <span class="cm-identifier">be</span> <span class="cm-identifier">working</span> <span class="cm-identifier">correctly</span><span class="cm-punctuation">.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-identifier">To</span> <span class="cm-identifier">generate</span> <span class="cm-identifier">this</span> <span class="cm-identifier">message</span><span class="cm-punctuation">,</span> <span class="cm-identifier">Docker</span> <span class="cm-identifier">took</span> <span class="cm-identifier">the</span> <span class="cm-identifier">following</span> <span class="cm-identifier">steps</span><span class="cm-operator">:</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-number">1.</span> <span class="cm-identifier">The</span> <span class="cm-identifier">Docker</span> <span class="cm-identifier">Engine</span> <span class="cm-builtin">CLI</span> <span class="cm-identifier">client</span> <span class="cm-identifier">contacted</span> <span class="cm-identifier">the</span> <span class="cm-identifier">Docker</span> <span class="cm-identifier">Engine</span> <span class="cm-identifier">daemon</span><span class="cm-punctuation">.</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-number">2.</span> <span class="cm-identifier">The</span> <span class="cm-identifier">Docker</span> <span class="cm-identifier">Engine</span> <span class="cm-identifier">daemon</span> <span class="cm-identifier">pulled</span> <span class="cm-identifier">the</span> <span class="cm-string">"hello-world"</span> <span class="cm-identifier">image</span> <span class="cm-keyword">from</span> <span class="cm-identifier">the</span> <span class="cm-identifier">Docker</span> <span class="cm-identifier">Hub</span><span class="cm-punctuation">.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-punctuation">(</span><span class="cm-identifier">Assuming</span> <span class="cm-identifier">it</span> <span class="cm-identifier">was</span> <span class="cm-identifier">not</span> <span class="cm-identifier">already</span> <span class="cm-identifier">locally</span> <span class="cm-identifier">available</span><span class="cm-punctuation">.)</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-number">3.</span> <span class="cm-identifier">The</span> <span class="cm-identifier">Docker</span> <span class="cm-identifier">Engine</span> <span class="cm-identifier">daemon</span> <span class="cm-identifier">created</span> <span class="cm-identifier">a</span> <span class="cm-identifier">new</span> <span class="cm-identifier">container</span> <span class="cm-keyword">from</span> <span class="cm-identifier">that</span> <span class="cm-identifier">image</span> <span class="cm-identifier">which</span> <span class="cm-identifier">runs</span> <span class="cm-identifier">the</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-identifier">executable</span> <span class="cm-identifier">that</span> <span class="cm-identifier">produces</span> <span class="cm-identifier">the</span> <span class="cm-identifier">output</span> <span class="cm-identifier">you</span> <span class="cm-identifier">are</span> <span class="cm-identifier">currently</span> <span class="cm-identifier">reading</span><span class="cm-punctuation">.</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-number">4.</span> <span class="cm-identifier">The</span> <span class="cm-identifier">Docker</span> <span class="cm-identifier">Engine</span> <span class="cm-identifier">daemon</span> <span class="cm-identifier">streamed</span> <span class="cm-identifier">that</span> <span class="cm-identifier">output</span> <span class="cm-identifier">to</span> <span class="cm-identifier">the</span> <span class="cm-identifier">Docker</span> <span class="cm-identifier">Engine</span> <span class="cm-builtin">CLI</span> <span class="cm-identifier">client</span><span class="cm-punctuation">,</span> <span class="cm-identifier">which</span> <span class="cm-identifier">sent</span> <span class="cm-identifier">it</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; <span class="cm-identifier">to</span> <span class="cm-identifier">your</span> <span class="cm-identifier">terminal</span><span class="cm-punctuation">.</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-identifier">To</span> <span class="cm-keyword">try</span> <span class="cm-identifier">something</span> <span class="cm-builtin">more</span> <span class="cm-identifier">ambitious</span><span class="cm-punctuation">,</span> <span class="cm-identifier">you</span> <span class="cm-identifier">can</span> <span class="cm-identifier">run</span> <span class="cm-identifier">an</span> <span class="cm-identifier">Ubuntu</span> <span class="cm-identifier">container</span> <span class="cm-identifier">with</span><span class="cm-operator">:</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-error">$</span> <span class="cm-identifier">docker</span> <span class="cm-identifier">run</span> <span class="cm-operator">-</span><span class="cm-identifier">it</span> <span class="cm-identifier">ubuntu</span> <span class="cm-identifier">bash</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-keyword">For</span> <span class="cm-builtin">more</span> <span class="cm-identifier">examples</span> <span class="cm-identifier">and</span> <span class="cm-identifier">ideas</span><span class="cm-punctuation">,</span> <span class="cm-identifier">visit</span><span class="cm-operator">:</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-identifier">https</span><span class="cm-operator">://</span><span class="cm-identifier">docs</span><span class="cm-punctuation">.</span><span class="cm-identifier">docker</span><span class="cm-punctuation">.</span><span class="cm-identifier">com</span><span class="cm-operator">/</span><span class="cm-identifier">userguide</span><span class="cm-operator">/</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 529px;"></div></div></div></pre><p>​</p></li></ul></li></ul><h2><a name='header-n63' class='md-header-anchor '></a>3 CentOS 7 下安装Docker</h2><p>​	安装版本 : <code>Docker  CE</code></p><p>​	系统要求 : <code>64 bit  CentOS 7</code></p><h3><a name='header-n68' class='md-header-anchor '></a>1 安装前准备</h3><p>​	卸载旧版的 docker , 输入下列指令</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">[root@localhost /]<span class="cm-comment"># sudo yum remove docker docker-common docker-selinux docker-engin</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">已加载插件：fastestmirror, langpacks</span></pre><pre class=""><span style="padding-right: 0.1px;">参数 docker 没有匹配</span></pre><pre class=""><span style="padding-right: 0.1px;">参数 docker-common 没有匹配</span></pre><pre class=""><span style="padding-right: 0.1px;">参数 docker-selinux 没有匹配</span></pre><pre class=""><span style="padding-right: 0.1px;">参数 docker-engin 没有匹配</span></pre><pre class=""><span style="padding-right: 0.1px;">不删除任何软件包</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><h3><a name='header-n72' class='md-header-anchor '></a>2 在线仓库安装</h3><ol start='' ><li><p>执行下面的指令更新依赖的包</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">[root@localhost /]<span class="cm-comment"># sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre></li></ol><blockquote><p>会联网更新系统的依赖 , 需要一些时间</p></blockquote><ol start='2' ><li><p>设置 docker 仓库地址地址</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">[root@localhost /]<span class="cm-comment"># sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">已加载插件：fastestmirror, langpacks</span></pre><pre class=""><span style="padding-right: 0.1px;">adding repo from: https://download.docker.com/linux/centos/docker-ce.repo</span></pre><pre class=""><span style="padding-right: 0.1px;">grabbing file https://download.docker.com/linux/centos/docker-ce.repo to /etc/yum.repos.d/docker-ce.repo</span></pre><pre class=""><span style="padding-right: 0.1px;">repo saved to /etc/yum.repos.d/docker-ce.repo</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre></li><li><p>更新 <code>yum</code> 包的索引</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">[root@localhost /]<span class="cm-comment"># sudo yum makecache fast</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">已加载插件：fastestmirror, langpacks</span></pre><pre class=""><span style="padding-right: 0.1px;">base &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | <span class="cm-number">3</span>.6 kB  <span class="cm-number">00</span>:00:00 &nbsp; &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;">docker-ce-stable &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | <span class="cm-number">2</span>.9 kB  <span class="cm-number">00</span>:00:00 &nbsp; &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;">extras &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | <span class="cm-number">3</span>.4 kB  <span class="cm-number">00</span>:00:00 &nbsp; &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;">updates &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; | <span class="cm-number">3</span>.4 kB  <span class="cm-number">00</span>:00:00 &nbsp; &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;">docker-ce-stable/x86_64/primary_db &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | <span class="cm-number">6</span>.8 kB  <span class="cm-number">00</span>:00:01 &nbsp; &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;">Loading mirror speeds from cached hostfile</span></pre><pre class=""><span style="padding-right: 0.1px;"> * base: mirror.bit.edu.cn</span></pre><pre class=""><span style="padding-right: 0.1px;"> * extras: mirror.lzu.edu.cn</span></pre><pre class=""><span style="padding-right: 0.1px;"> * updates: mirrors.cn99.com</span></pre><pre class=""><span style="padding-right: 0.1px;">元数据缓存已建立</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 276px;"></div></div></div></pre></li><li><p>安装最新版本的 <code>docker-ce</code></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">[root@localhost /]<span class="cm-comment"># sudo yum install docker-ce</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre></li></ol><blockquote><p>1 可以通过 <code>sudo yum list docker-ce.x86_64 --showduplicates | sort -r</code> 来查看安装包列表</p><p>2 通过 <code>sudo yum install dokcer-ce-&lt;VERSION&gt;</code> 来安装指定的版本</p></blockquote><ol start='5' ><li><p>启动 <code>docker</code></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">[root@localhost /]<span class="cm-comment"># systemctl start docker</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre></li></ol><blockquote><p>CentOS 7 使用了新的命令 <code>systemctl</code> 来替代 <code>service</code> </p></blockquote><ol start='6' ><li><p>运行 <code>hello-world</code> 镜像 , 验证 docker 是否安装成功</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">[root@localhost /]<span class="cm-comment"># docker run  hub.c.163.com/library/hello-world:latest</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">Unable to <span class="cm-builtin">find</span> image <span class="cm-string">'hub.c.163.com/library/hello-world:latest'</span> locally</span></pre><pre class=""><span style="padding-right: 0.1px;">latest: Pulling from library/hello-world</span></pre><pre class=""><span style="padding-right: 0.1px;">7a9d05de7670: Pull complete </span></pre><pre class=""><span style="padding-right: 0.1px;">Digest: sha256:7391d42f476e10480a3da94f15233703f6c6abcd9b5165e390121f867039a6df</span></pre><pre class=""><span style="padding-right: 0.1px;">Status: Downloaded newer image <span class="cm-keyword">for</span> hub.c.163.com/library/hello-world:latest</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Hello from Docker!</span></pre><pre class=""><span style="padding-right: 0.1px;">This message shows that your installation appears to be working correctly.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">To generate this message, Docker took the following steps:</span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-number">1</span>. The Docker client contacted the Docker daemon.</span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-number">2</span>. The Docker daemon pulled the <span class="cm-string">"hello-world"</span> image from the Docker Hub.</span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-number">3</span>. The Docker daemon created a new container from that image which runs the</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  executable that produces the output you are currently reading.</span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-number">4</span>. The Docker daemon streamed that output to the Docker client, which sent it</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  to your terminal.</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">To try something more ambitious, you can run an Ubuntu container with:</span></pre><pre class=""><span style="padding-right: 0.1px;"> <span class="cm-def">$ docker</span> run <span class="cm-attribute">-it</span> ubuntu <span class="cm-builtin">bash</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Share images, automate workflows, and more with a free Docker ID:</span></pre><pre class=""><span style="padding-right: 0.1px;"> https://cloud.docker.com/</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">For more examples and ideas, visit:</span></pre><pre class=""><span style="padding-right: 0.1px;"> https://docs.docker.com/engine/userguide/</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 598px;"></div></div></div></pre></li></ol><blockquote><p>出现上面的信息后,就说明dokcer 安装成功了, 可以使用  <code>docker version</code>来查看当前 <code>docker</code> 的版本信息</p></blockquote><p></p><h2><a name='header-n117' class='md-header-anchor '></a>4 Docker镜像</h2><p>​	Docker运行容器前需要本地存在对应的镜像,如果没有,docker会尝试从默认镜像仓库中进行下载(Docker Hub仓库),用户也可以配置使用自定义的仓库</p><p>​	<strong>docker的<a href='https://hub.docker.com/explore/'>官方镜像仓库地址</a></strong> </p><p>​	<a href='https://c.163.com/hub#/m/home/'>网易蜂巢镜像中心</a></p><p></p><p><img src='%E4%BB%93%E5%BA%93.png' alt='蜂巢仓库' /></p><h3><a name='header-n128' class='md-header-anchor '></a>1 拉取镜像</h3><p>​	命令行格式: <code>docker  pull  NAME[:TAG]</code></p><blockquote><p>其中 NAME	 : 	镜像仓库的名称,用于区分镜像</p><p>​	 TAG	:	镜像的标签,用来指定版本号	</p></blockquote><p><img src='redis.png' alt='' /></p><ul><li><p>从官网仓库拉取redis镜像</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>docker pull redis &nbsp; 等效于 &nbsp; docker pull redis[:latest]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><blockquote><p>如果不指定 <code>tag</code> ,会默认选择 <code>latest</code> 标签,即最新版本的镜像</p></blockquote></li><li><p>从网易蜂巢拉取redis镜像</p><pre class="md-fences md-end-block" lang="shell"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>docker pull hub.c.163.com/library/redis:latest</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre></li></ul><p><img src='redis163.png' alt='' /></p><blockquote><p>非官网的镜像地址,需要在镜像仓库名称前指定完整的仓库地址</p></blockquote><p>​	下面是从蜂巢拉取redis时的输出信息:</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> pull hub.c.163.com/library/redis:latest</span></pre></div><pre class=""><span style="padding-right: 0.1px;">latest: Pulling from library/redis</span></pre><pre class=""><span style="padding-right: 0.1px;">5040bd298390: Pull complete </span></pre><pre class=""><span style="padding-right: 0.1px;">996f41e871db: Pull complete </span></pre><pre class=""><span style="padding-right: 0.1px;">a40484248761: Pull complete </span></pre><pre class=""><span style="padding-right: 0.1px;">a97af2bf2ee7: Pull complete </span></pre><pre class=""><span style="padding-right: 0.1px;">010c454d55e5: Pull complete </span></pre><pre class=""><span style="padding-right: 0.1px;">142d4cb3dc08: Pull complete </span></pre><pre class=""><span style="padding-right: 0.1px;">6666ac0e527e: Pull complete </span></pre><pre class=""><span style="padding-right: 0.1px;">Digest: sha256:75b4b101bdb98475e8acf8410bef7f1a47fa5de1c22ed629c77ce37491cca68e</span></pre><pre class=""><span style="padding-right: 0.1px;">Status: Downloaded newer image <span class="cm-keyword">for</span> hub.c.163.com/library/redis:latest</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 253px;"></div></div></div></pre><blockquote><p>可以看到镜像由一系列层(layer)组成,<code>5040bd...</code>类似的字符串是各个层的唯一标识符,非常类似Git仓库中的commit</p><p>镜像默认存储在 <code>/var/lib/docker</code> 路径下 , 该路径也可以使用 <code>docker daemon -g</code> 参数在启动 <code>Daemon</code> 时指定</p></blockquote><h3><a name='header-n163' class='md-header-anchor '></a>2 查看镜像信息</h3><p><strong>1  命令<code>images</code>列出本地镜像</strong></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker<span class="cm-tab">  </span>images</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p>如下</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre></div><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">hello-world &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1815c82652c0 &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span>.84 kB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre><blockquote><p>REPOSITORY		说明镜像来源的仓库</p><p>TAG				说明版本号信息,latest指最新版</p><p>IMAGE ID		镜像的唯一ID</p></blockquote><p>关于images更多的命令选项,可以输入 <code>man docker -images</code>查看</p><p><strong>2 命令<code>tag</code>给镜像添加别名</strong></p><pre class='md-fences mock-cm' style='display:block;position:relative'>docker  tag	 本地镜像名	tag标签名		</pre><p>如下: <code>docker tag hub.c.163.com/library/redis  redis163</code></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre></div><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">hello-world &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1815c82652c0 &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span>.84 kB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> tag hub.c.163.com/library/redis redis163 </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">hello-world &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1815c82652c0 &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span>.84 kB</span></pre><pre class=""><span style="padding-right: 0.1px;">redis163 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 276px;"></div></div></div></pre><blockquote><p>可以看到 redis163 和 hub.c.163.com/library/redis 两个镜像的 ID 是一样的,也就是说,以后用户可以直接使用 redis163 这个镜像表示 hub.c.163.com/library/redis</p></blockquote><p><strong>3 命令<code>inspect</code>查看镜像信息</strong></p><p>​	格式 : <code>docker inspect 镜像仓库名称</code></p><pre class="md-fences md-end-block" lang="json"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-variable">huangyunningdeMacBook</span><span class="cm-operator">-</span><span class="cm-variable">Pro</span>:<span class="cm-operator">~</span> <span class="cm-variable">huangyunning$</span> <span class="cm-variable">docker</span> <span class="cm-variable">inspect</span> <span class="cm-variable">redis163</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">[</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"Id"</span>: <span class="cm-string">"sha256:45c3ea2cecac5fef8c3838cc4b58666657df8541e14437964c8b88f355f372c8"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"RepoTags"</span>: [</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"redis163:latest"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"hub.c.163.com/library/redis:latest"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  ],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"RepoDigests"</span>: [</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"hub.c.163.com/library/redis@sha256:75b4b101bdb98475e8acf8410bef7f1a47fa5de1c22ed629c77ce37491cca68e"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  ],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"Parent"</span>: <span class="cm-string">""</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"Comment"</span>: <span class="cm-string">""</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"Created"</span>: <span class="cm-string">"2017-01-17T20:06:29.296031465Z"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string cm-property">"Container"</span>: <span class="cm-string">"82f00fae041be8793ea75122705fb1730ea9df8ef1cc9a28c654396cbded9b72"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-meta">...</span> <span class="cm-variable">省略一堆信息</span> <span class="cm-meta">...</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string">"RootFS"</span>: {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"Type"</span>: <span class="cm-string">"layers"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"Layers"</span>: [</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"sha256:a2ae92ffcd29f7ededa0320f4a4fd709a723beae9a4e681696874932db7aee2c"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"sha256:387483b2c71541ea1f25f0e4f1d120f3306abdfb1aca8868f1d0fbb63cd932d1"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"sha256:307248831acaa33a836f172d5cf821baf5fa0f9e475d9a3d83fe62d80c6be517"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"sha256:c235d5b4caa380ee5a45fdd5e561335eca40f5842dfabe263a89ef1fdd54557c"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"sha256:af287523a42a540ca038b875cd4239687ee7d89cd6793da2a060797afba001e5"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"sha256:552b670af77417fd1c21c6bd111079b2d073669118568b19cd1898f8aa50823d"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"sha256:4cefd98bbdaf8adc050c0028f0a3c0af5f868dbb2a513b06bc48d087f5706fd7"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  ]</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;">]</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 690px;"></div></div></div></pre><p>​	返回的信息是一个json字符串,如果只想查看某个节点的信息可以添加 <code>-f {{&quot;.节点名&quot;}}</code>,如,只看  <code>Id</code> 节点的信息的命令为 <code>docker inspect redis163 -f {{&quot;.Id&quot;}}</code></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> inspect redis163 <span class="cm-attribute">-f</span> {{<span class="cm-string">".Id"</span>}}</span></pre></div><pre class=""><span style="padding-right: 0.1px;">sha256:45c3ea2cecac5fef8c3838cc4b58666657df8541e14437964c8b88f355f372c8</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p><strong>4 命令 <code>search</code>搜索镜像</strong></p><p>​	格式: <code>docker search 镜像仓库名</code> </p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> search nginx</span></pre></div><pre class=""><span style="padding-right: 0.1px;">NAME &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; DESCRIPTION &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STARS &nbsp; &nbsp; OFFICIAL &nbsp; AUTOMATED</span></pre><pre class=""><span style="padding-right: 0.1px;">nginx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Official build of Nginx. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">6403</span> &nbsp; &nbsp;  [OK] &nbsp; &nbsp; &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;">jwilder/nginx-proxy &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Automated Nginx reverse proxy <span class="cm-keyword">for</span> docker c... &nbsp; <span class="cm-number">1063</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [OK]</span></pre><pre class=""><span style="padding-right: 0.1px;">richarvey/nginx-php-fpm &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Container running Nginx <span class="cm-operator">+</span> PHP-FPM capable ... &nbsp; <span class="cm-number">405</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  [OK]</span></pre><pre class=""><span style="padding-right: 0.1px;">jrcs/letsencrypt-nginx-proxy-companion &nbsp; LetsEncrypt container to use with nginx as... &nbsp; <span class="cm-number">199</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  [OK]</span></pre><pre class=""><span style="padding-right: 0.1px;">kong &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Open-source Microservice &amp; API Management ... &nbsp; <span class="cm-number">87</span> &nbsp; &nbsp; &nbsp;  [OK] &nbsp; &nbsp; &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;">webdevops/php-nginx &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  Nginx with PHP-FPM &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">85</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; [OK]</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre><h3><a name='header-n201' class='md-header-anchor '></a>3 删除镜像</h3><blockquote><p><code>docker rm  $(docker ps -q -a)</code> 		一次性删除所有的容器</p><p><code>docker rmi $(docker images -q)</code> 		一次性删除所有的镜像</p></blockquote><ul><li><p>使用标签删除镜像</p><p>格式 : <code>docker rmi IMAGE [IMAGE2 IMAGE3...]</code> ,其中<code>IMAGE</code>可以为标签tag或镜像ID</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre></div><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">hello-world &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1815c82652c0 &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span>.84 kB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">redis163 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> rmi redis163</span></pre><pre class=""><span style="padding-right: 0.1px;">Untagged: redis163:latest</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">hello-world &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1815c82652c0 &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span>.84 kB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></pre><blockquote><p>可以看到,当通过标签tag删除时,如果镜像文件有多个标签时,之后删除标签,镜像文件并没有被删除,当只有一个标签时,镜像才会被删除		</p></blockquote></li></ul><ul><li><p>使用镜像ID删除镜像</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre></div><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">hello-world &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1815c82652c0 &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span>.84 kB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> rmi 1815c82652c0</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Untagged: hello-world:latest</span></pre><pre class=""><span style="padding-right: 0.1px;">Untagged: hello-world@sha256:f3b3b28a45160805bb16542c9531888519430e9e6d6ffc09d72261b0d26ff74f</span></pre><pre class=""><span style="padding-right: 0.1px;">Deleted: sha256:1815c82652c03bfd8644afda26fb184f2ed891d921b20a0703b46768f9755c57</span></pre><pre class=""><span style="padding-right: 0.1px;">Deleted: sha256:45761469c965421a92a69cc50e92c01e0cfa94fe026cdd1233445ea00e96289a</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><blockquote><p>根据ID删除时,系统会尝试删除所有指向该镜像的标签,然后删除该镜像文件本身</p></blockquote><blockquote><p>注意,如果存在使用了该镜像创建的容器时,镜像的本身文件将无法删除,此时需要先删除容器</p><p>​	查看本地上的容器命令为 	<code>docker ps -a</code></p><p>​	删除指定容器 的命令为	      <code>docker rm 容器ID</code></p><p>​	强制删除(慎用)			<code>docker rmi -f 容器</code></p></blockquote></li></ul><h3><a name='header-n234' class='md-header-anchor '></a>4 创建镜像</h3><ul><li><p>创建的镜像由3种方法:</p><ul><li>基于已有镜像的容器创建</li><li>基于本地模板导入</li><li>基于<code>Dockerfile</code>创建</li></ul></li></ul><p><strong>1 基于已有镜像的容器创建</strong></p><p>​	格式 : <code>docker commit [OPTION] CONTAINER [RESPOSITORY[:TAG]]</code></p><p>​	OPTION 的常用选项如下:</p><pre class='md-fences mock-cm' style='display:block;position:relative'>	-a   	作者信息
	-c		提交时执行的 Dockerfile命令
	-m		提交时的备注信息
	p		提交时暂停容器运行</pre><p>​	下面演示该命令创建一个镜像,首先先从蜂巢中心下载一个ubuntu镜像,并给镜像起标签叫 ubuntu ,如下</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> pull hub.c.163.com/library/ubuntu:latest</span></pre></div><pre class=""><span style="padding-right: 0.1px;">latest: Pulling from library/ubuntu</span></pre><pre class=""><span style="padding-right: 0.1px;">... 省略信息 ...</span></pre><pre class=""><span style="padding-right: 0.1px;">Digest: sha256:951b9b6a22f7d7fc98854bcda15c2bc950788c2846c25ffa740d3efd86ec132e</span></pre><pre class=""><span style="padding-right: 0.1px;">Status: Downloaded newer image <span class="cm-keyword">for</span> hub.c.163.com/library/ubuntu:latest</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> tag hub.c.163.com/library/ubuntu ubuntu</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">ubuntu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  d355ed3537e9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">3</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/ubuntu &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  d355ed3537e9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">3</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp;  latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></pre><p>​	然后,启动ubuntu镜像,并在其中添加一个文件叫   <code>itheima.txt</code> ,然后退出</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> run <span class="cm-attribute">-it</span> ubuntu /bin/bash</span></pre></div><pre class=""><span style="padding-right: 0.1px;">root@8e5d88c09922:/<span class="cm-comment"># ls</span></span></pre><pre class=""><span style="padding-right: 0.1px;">bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span></pre><pre class=""><span style="padding-right: 0.1px;">root@8e5d88c09922:/<span class="cm-comment"># touch itheima.txt</span></span></pre><pre class=""><span style="padding-right: 0.1px;">root@8e5d88c09922:/<span class="cm-comment"># ls</span></span></pre><pre class=""><span style="padding-right: 0.1px;">bin  boot  dev  etc  home  itheima.txt  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span></pre><pre class=""><span style="padding-right: 0.1px;">root@8e5d88c09922:/<span class="cm-comment"># exit</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">exit</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 184px;"></div></div></div></pre><blockquote><p>​	&gt;<code>root@8e5d88c09922</code>中的<code>8e5d88c09922</code>即为当前容器的ID,创建新镜像时需要使用到</p></blockquote><p>​	接下来,使用   <code>docker commit</code>创建新的镜像</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> commit <span class="cm-attribute">-m</span> <span class="cm-string">"添加了文件itheima.txt"</span> <span class="cm-attribute">-a</span> <span class="cm-string">"蜂蜜110"</span> 8e5d88c09922 test:0.1</span></pre></div><pre class=""><span style="padding-right: 0.1px;">sha256:c4cf9109cee7b7a3ab7a27d0c8cffe3c07b731411c78735ec35863e6874eeb99</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p>​	当返回新镜像的ID信息时,说明创建成功,可以使用   <code>docker images</code> 查看</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre></div><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">test &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span>.1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c4cf9109cee7 &nbsp; &nbsp; &nbsp;  <span class="cm-number">21</span> seconds ago &nbsp; &nbsp;  <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">ubuntu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  d355ed3537e9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">3</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/ubuntu &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  d355ed3537e9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">3</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp;  latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 138px;"></div></div></div></pre><blockquote><p>可以看到最新创建的 test 镜像</p></blockquote><p><strong>2 基于本地模板导入(了解)</strong></p><p>​	格式 : <code>docker import [OPTION]    文件名|URL|- [REPOSITORY[:TAG]]</code></p><p>​	即导入模板镜像,模板可以是从OpenVZ提供的模板,或者使用导出的镜像制作成的模板.<a href='https://download.openvz.org/template/precreated/'>OpenVZ模板下载地址</a></p><p><strong>3 基于<code>Dockerfile</code>创建</strong></p><pre class='md-fences mock-cm' style='display:block;position:relative'>&gt;待完善</pre><h3><a name='header-n284' class='md-header-anchor '></a>5 保存和载入镜像</h3><p><strong>1 保存镜像</strong></p><p>​	格式   :   <code>docker save 本地镜像名  &gt;  保存的全路径</code> , 其中 <code>&gt;</code>是重定向符,指定文件输出</p><p>​	或者    <code>docker save -o 本地镜像名  保存的全路径</code></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> save hello-world &gt; /Users/huangyunning/temp/hello-word.tar</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ ls</span> <span class="cm-attribute">-l</span> /Users/huangyunning/temp/hello-word.tar</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-attribute">-rw-r--r--</span>  <span class="cm-number">1</span> huangyunning  staff  <span class="cm-number">12800</span>  <span class="cm-number">7</span> <span class="cm-number">13</span> <span class="cm-number">12</span>:36 /Users/huangyunning/temp/hello-word.tar</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre><blockquote><p>此时在<code>/Users/huangyunning/temp</code>目录下即可看到导出的镜像 <code>hello-world.tar</code></p></blockquote><p><strong>2 载入镜像</strong></p><p>​	格式 :    <code>docker load --input 镜像名</code> 或者 <code>docker load &lt; 镜像名</code></p><p>​	如下,先删除   <code>hello-world</code>镜像,然后再导入之前保存的镜像</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> rmi hello-world</span></pre></div><pre class=""><span style="padding-right: 0.1px;">Untagged: hello-world:latest</span></pre><pre class=""><span style="padding-right: 0.1px;">Deleted: sha256:1815c82652c03bfd8644afda26fb184f2ed891d921b20a0703b46768f9755c57</span></pre><pre class=""><span style="padding-right: 0.1px;">Deleted: sha256:45761469c965421a92a69cc50e92c01e0cfa94fe026cdd1233445ea00e96289a</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">test &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span>.1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c4cf9109cee7 &nbsp; &nbsp; &nbsp;  <span class="cm-number">44</span> minutes ago &nbsp; &nbsp;  <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">ubuntu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  d355ed3537e9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">3</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/ubuntu &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  d355ed3537e9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">3</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp;  latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> load &lt; /Users/huangyunning/temp/hello-word.tar</span></pre><pre class=""><span style="padding-right: 0.1px;">45761469c965: Loading layer [<span class="cm-operator">==================================================</span>&gt;] <span class="cm-number">3</span>.584 kB/3.584 kB</span></pre><pre class=""><span style="padding-right: 0.1px;">Loaded image: hello-world:latest</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><p><strong>3 上传镜像</strong></p><p>​	上传到Docker Hub(官方仓库)</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>docker push NAME[:TAG]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><blockquote><p>1 要上传镜像到Docker Hub,需要去官网注册帐号,在执行推送镜像命令时,系统会提示输入帐号密码;或者在执行推送前,先在命令行窗口使用帐号登录</p><p>2 命令行登录的指令: 	<code>docker login -u=username -p=password</code>	</p><p>3 上传镜像到 <code>Docker hub</code> ,需要自备梯子翻墙...</p></blockquote><p>上传到指定仓库:先使用<code>docker tag</code>给自己的镜像起个标签,然后上传.标签的格式 :  <code>指定仓库地址:端口号/仓库名</code></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>docker push 仓库ip地址:端口号/<span class="cm-tab"> </span>NAME[:TAG]</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>例如: docker push <span class="cm-number">192</span>.168.45.100:8888/hello-world:latest</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><h2><a name='header-n317' class='md-header-anchor '></a>5 Docker容器</h2><p>​	容器是Docker的另一个核心概念,简单的说容器可以认为是镜像的一个运行实例.不同的是,镜像是静态的文件,而容器带有运行时需要的可写文件层.可以认为Docker容器就是一个独立运行的一个(或一组)应用,以及他们必需的运行环境</p><ul><li><p><strong>容器的操作:</strong></p><ul><li>创建容器</li><li>启动容器</li><li>终止容器</li><li>进入容器</li><li>删除容器</li><li>容器的导入导出</li></ul></li></ul><h3><a name='header-n343' class='md-header-anchor '></a>1 创建容器</h3><p>​	命令 : <code>docker create</code> ,例如</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images &nbsp;  <span class="cm-tab"> </span> <span class="cm-comment">#查看系统上的镜像</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">test &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">0</span>.1 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; c4cf9109cee7 &nbsp; &nbsp; &nbsp;  <span class="cm-number">7</span> hours ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">ubuntu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  d355ed3537e9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">3</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> create <span class="cm-attribute">-it</span> ubuntu<span class="cm-tab">  </span><span class="cm-tab">    </span><span class="cm-comment">#使用ubuntu镜像创建一个容器</span></span></pre><pre class=""><span style="padding-right: 0.1px;">72ea1222c4e11e29baa4c4866d19bf1b4aac389aedc0ea44ea46c88fb32e1c3e<span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">#返回创建的容器的id</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span> <span class="cm-attribute">-a</span> &nbsp; <span class="cm-tab">   </span><span class="cm-comment">#查看所有的容器</span></span></pre><pre class=""><span style="padding-right: 0.1px;">CONTAINER ID &nbsp; &nbsp; &nbsp;  IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</span></pre><pre class=""><span style="padding-right: 0.1px;">72ea1222c4e1 &nbsp; &nbsp; &nbsp;  ubuntu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"/bin/bash"</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">5</span> seconds ago &nbsp; &nbsp; &nbsp; Created &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; admiring_mcnulty</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></pre><blockquote><p><code>-it</code>是选项 <code>-i</code> <code>-t</code> 的合并写法</p><p><code>-i</code>	让容器的标准输入保持打开</p><p><code>-t</code>	让Docker分配一个伪终端(pseudo-tty)并绑定倒容器的标准输入流上</p></blockquote><p>​	<code>create</code>命令和后面讲到的<code>run</code>命令支持的选项很复杂,包括如下几个大类:</p><ul><li><p>与容器运行模式相关的</p><blockquote><p><code>-d,--detach=true|false</code>		是否是后台运行的容器,默认<code>false</code></p><p><code>-i,--interactive=true|false</code>	保持标准输入打开,默认<code>false</code></p><p><code>-t,--tty=true|false</code>			是否分配一个伪终端,默认<code>false</code></p><p><code>--net=&quot;bridge|host|none..&quot;</code>	指定容器的网络模式,默认<code>bridge</code>桥接</p><p><code>-p</code>							指定端口映射,例如 <code>-p 11234-12234:1234-2234</code></p><p><code>--restart=&quot;no|always|..&quot;</code>		容器的重启策略,包括 <code>no,on-failure[:max-retry],always,unless-stopped</code>等		</p><p><code>-w,--workdir=&quot;&quot;</code>				容器内的默认工作目录</p><p><code>-v|--volumn[=[[host-dir:]container-dir[:OPTIONS]]]</code>	挂载主机上的文件卷到容器</p><p>​	</p></blockquote></li><li><p>与容器和环境配置相关的</p><blockquote><p><code>--device=[]</code>					映射物理机上的设备到容器内</p><p><code>-e,--env=[]</code>					指定容器内的环境变量</p><p><code>-h,--hostname=&quot;&quot;</code>			指定容器内的主机名</p><p><code>--ip</code>						指定容器的IPv4地址</p><p><code>--name=&quot;&quot;</code>					指定容器的别名</p></blockquote></li><li><p>与容器资源限制和安全保护相关的</p><blockquote><p><code>cpu-shares=0</code>				允许容器使用cpu资源的相对权重,默认是一个容器能用满一个核的cpu</p><p><code>cpu-period=0</code>				限制容器在CFS调度器下的cpu占用时间片</p><p><code>--pid-limit=&quot;&quot;</code>				限制容器的pid个数</p><p><code>--privileged=true|false</code>		是否给容器分配高权限,一般不推荐</p><p><code>--oom-kill-disable=true|false</code>	内存耗尽时,是否杀死容器</p></blockquote><p>以上只是部分选项,更多选项信息请查看相关文档</p></li></ul><h3><a name='header-n409' class='md-header-anchor '></a>2 启动容器</h3><p>​	格式 :  <code>docker start 容器ID</code></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span> <span class="cm-attribute">-a</span><span class="cm-tab">  </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">#查看本地的容器</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">CONTAINER ID &nbsp; &nbsp; &nbsp;  IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</span></pre><pre class=""><span style="padding-right: 0.1px;">72ea1222c4e1 &nbsp; &nbsp; &nbsp;  ubuntu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"/bin/bash"</span> &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">3</span> hours ago &nbsp; &nbsp; &nbsp; &nbsp; Created &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; admiring_mcnulty</span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">start</span> 72ea1222c4e1<span class="cm-tab"> </span><span class="cm-tab">    </span><span class="cm-comment">#根据容器ID启动容器</span></span></pre><pre class=""><span style="padding-right: 0.1px;">72ea1222c4e1</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 161px;"></div></div></div></pre><h3><a name='header-n413' class='md-header-anchor '></a>3 新建并启动容器</h3><p>​	格式: <code>docker run IMAGE</code></p><pre class='md-fences mock-cm' style='display:block;position:relative'>&gt;该命令等价于 先执行 `docker create` 然后执行  `docker start`</pre><p>​	下面的命令输出 <code>&#39;Hello Docker~~&#39;</code> ,然后容器自动终止</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> run ubuntu /bin/echo <span class="cm-string">'Hello Docker~~'</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">Hello Docker~~</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p>​	后台执行    <code>docker run</code>的标准操作包括:</p><pre class='md-fences mock-cm' style='display:block;position:relative'>1 检查本地是否存在指定的镜像,不存在就从共有仓库下载;</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>2 使用镜像创建容器并启动</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>3 分配一个文件系统给容器,并在只读的镜像层外面挂载一层可读写层</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>4 从宿主主机配置的网桥接口中桥接一个虚拟接口到容器</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>5 从网桥的地址池配置一个IP地址给容器</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>6 执行用户指定的应用程序</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>7 执行完毕后容器自动终止</pre><p>​	下面的命令 <code>docker run -it ubuntu /bin/bash</code> 启动一个<code>bash</code>终端,并允许用户进行交互</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> run <span class="cm-attribute">-it</span> ubuntu /bin/bash </span></pre></div><pre class=""><span style="padding-right: 0.1px;">root@b6f00c07dc74:/<span class="cm-comment"># pwd <span class="cm-tab">   </span><span class="cm-tab">    </span># 查看容器内的当前目录</span></span></pre><pre class=""><span style="padding-right: 0.1px;">/</span></pre><pre class=""><span style="padding-right: 0.1px;">root@b6f00c07dc74:/<span class="cm-comment"># ls<span class="cm-tab"> </span><span class="cm-tab">    </span><span class="cm-tab">    </span># 查看当前目录下的文件</span></span></pre><pre class=""><span style="padding-right: 0.1px;">bin  boot  dev  etc  home  lib  lib64  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">root@b6f00c07dc74:/<span class="cm-comment"># ps<span class="cm-tab"> </span><span class="cm-tab">    </span><span class="cm-tab">    </span># 查看容器运行的进程,可以看到只运行了 bash 应用</span></span></pre><pre class=""><span style="padding-right: 0.1px;">  PID TTY &nbsp; &nbsp; &nbsp; &nbsp;  TIME CMD</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-number">1</span> pts/0 &nbsp;  <span class="cm-number">00</span>:00:00 <span class="cm-builtin">bash</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; <span class="cm-number">10</span> pts/0 &nbsp;  <span class="cm-number">00</span>:00:00 <span class="cm-builtin">ps</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; </span></pre><pre class=""><span style="padding-right: 0.1px;">root@b6f00c07dc74:/<span class="cm-comment"># exit<span class="cm-tab">   </span><span class="cm-tab">    </span># 使用 exit 退出容器 或者 ctrl + d</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">exit</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span> <span class="cm-attribute">-a</span> &nbsp; <span class="cm-comment"># 查看容器,可以看到 exit 后,容器就属于Exited 状态了</span></span></pre><pre class=""><span style="padding-right: 0.1px;">CONTAINER ID &nbsp; &nbsp; &nbsp;  IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</span></pre><pre class=""><span style="padding-right: 0.1px;">b6f00c07dc74 &nbsp; &nbsp; &nbsp;  ubuntu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"/bin/bash"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">9</span> minutes ago &nbsp; &nbsp; &nbsp; Exited (0) About a minute ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; cocky_heyrovsky</span></pre><pre class=""><span style="padding-right: 0.1px;">b8540a349de3 &nbsp; &nbsp; &nbsp;  ubuntu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"/bin/echo 'Hello ..."</span> &nbsp; <span class="cm-number">19</span> minutes ago &nbsp; &nbsp;  Exited (0) <span class="cm-number">19</span> minutes ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elastic_ardinghelli</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 483px;"></div></div></div></pre><blockquote><p>选项	 <code>-i</code> 	让容器的标准输入保持打开</p><p>​	     	 <code>-t</code> 	让Docker分配一个为终端并绑定到容器的标准输入上</p></blockquote><p>​	某些情况下, <code>docker run</code>会出错,常见的错误代码如下:</p><ul><li>125 : Docker daemon 执行出错,例如指定了不支持的Docker命令参数</li><li>126 : 指定的命令无法执行,例如权限出错</li><li>127 : 容器内命令无法找到</li></ul><h3><a name='header-n455' class='md-header-anchor '></a>4 守护态运行</h3><p>​	即在后台运行,此时通过添加参数 <code>-d</code> 即可,例如 如下指令让执行循环,不断打印 &quot;hello itheima~&quot;</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> run <span class="cm-attribute">-d</span> ubuntu /bin/sh <span class="cm-attribute">-c</span> <span class="cm-string">"while true;do echo Hello itheima~;sleep 1; done"</span> &nbsp; <span class="cm-comment"># 后台执行命令</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">8a39c510e073062cc6827a1531f9611470594bdf19a31717305f4bdf46d2163d</span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span>  <span class="cm-comment"># 查看运行的进程</span></span></pre><pre class=""><span style="padding-right: 0.1px;">CONTAINER ID &nbsp; &nbsp; &nbsp;  IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</span></pre><pre class=""><span style="padding-right: 0.1px;">8a39c510e073 &nbsp; &nbsp; &nbsp;  ubuntu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"/bin/sh -c 'while..."</span> &nbsp; <span class="cm-number">7</span> seconds ago &nbsp; &nbsp; &nbsp; Up <span class="cm-number">6</span> seconds &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  elegant_joliot</span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> logs 8a39c510e073  <span class="cm-comment"># 查看容器的输出信息</span></span></pre><pre class=""><span style="padding-right: 0.1px;">Hello itheima~</span></pre><pre class=""><span style="padding-right: 0.1px;">Hello itheima~</span></pre><pre class=""><span style="padding-right: 0.1px;">Hello itheima~</span></pre><pre class=""><span style="padding-right: 0.1px;">Hello itheima~</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></pre><blockquote><p>当容器在后台运行时,要查看容器的输出信息可使用 <code>docker logs  容器ID</code> 查看</p><p><code>/bin/sh   -c   &quot;argument&quot;</code>  传递一个字符串参数给 <code>sh</code> </p></blockquote><h3><a name='header-n464' class='md-header-anchor '></a>5 终止容器</h3><p>​	格式 : <code>docker stop [-t|--time[=10]] [container ...]</code></p><p>​	该命令向容器发送SIGTERM信号,超时一段时间(默认10s)后 ,再发送SIGKILL信号终止容器</p><pre class='md-fences mock-cm' style='display:block;position:relative'>当容器中指定的应用终结时,容器也会自动终止.</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>`docker restart` 会将容器先终止然后再启动</pre><p>​		<code>docker  ps  -qa</code> 可以查看所有容器的ID,例如</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span> <span class="cm-attribute">-qa</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">8a39c510e073</span></pre><pre class=""><span style="padding-right: 0.1px;">390e29955b40</span></pre><pre class=""><span style="padding-right: 0.1px;">92a7488944b9</span></pre><pre class=""><span style="padding-right: 0.1px;">c74758fa80b5</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre><h3><a name='header-n475' class='md-header-anchor '></a>6 进入容器</h3><p>​	当使用 <code>-d</code>使容器在后台运行时,用户无法看到容器中的信息,也无法进行操作,这个时候需要特定的方法进入容器的内部.</p><p>这里介绍命令 <code>exec</code></p><p>​	<strong><code>exec</code></strong>是Docker从1.3.0版本起提供的命令,可以在容器内直接执行任意命令,命令格式</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker exec [-d] [--detach-keys[<span class="cm-operator">=</span>[]]] [-i] [--privileged] [-t] [-u|--user[<span class="cm-operator">=</span>USER]] container COMMAND [ARG...] </span></pre></div><pre class=""><span style="padding-right: 0.1px;">或者</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># docker exec [OPTIONS] CONTAINER COMMAND [ARG...]</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><p>​	比较重要的参数:</p><blockquote><p><code>-i,--interactive=true|false</code>	打开标准输入接受用户输入的命令,默认为<code>false</code></p><p><code>--privileged=true|false</code>		是否以高权限执行命令,默认为<code>false</code></p><p><code>-t,--tty=true|false</code>			是否分配伪终端,默认<code>false</code></p><p><code>-u,--user=&quot;&quot;</code>				执行命令的用户名或ID</p></blockquote><p>​	如下命令,以守护态启动容器并启动一个bash后,通过  <code>exec</code>进入容器内部</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> run <span class="cm-attribute">-d</span> ubuntu /bin/bash <span class="cm-tab">   </span><span class="cm-comment">#守护态启动容器</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">f3459c54e600cb69e9d61e9c82231825fa122cd05c5d694f58451eee30c1997f</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span></span></pre><pre class=""><span style="padding-right: 0.1px;">CONTAINER ID &nbsp; &nbsp; &nbsp;  IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</span></pre><pre class=""><span style="padding-right: 0.1px;">8a39c510e073 &nbsp; &nbsp; &nbsp;  ubuntu &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"/bin/sh -c 'while..."</span> &nbsp; <span class="cm-number">22</span> minutes ago &nbsp; &nbsp;  Up <span class="cm-number">22</span> minutes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elegant_joliot</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> exec <span class="cm-attribute">-it</span> 8a39c510e073 /bin/sh</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># &nbsp; &nbsp;  !!这里是打开的终端</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 253px;"></div></div></div></pre><h3><a name='header-n497' class='md-header-anchor '></a>7 删除容器</h3><p>​	 <code>docker rm</code> 该命令用来删除处于终止或退出状态的容器,命令格式如下:</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker <span class="cm-builtin">rm</span> [-f] [-l] [-v] container [container ...]</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p>​	主要的选项:</p><blockquote><p><code>-f,--force=false</code>	是否强制终止并删除容器</p><p><code>-l,--link=false</code>		删除容器的连接,但保留容器</p><p><code>-v,--volumes=false</code>	删除容器挂载的数据卷</p></blockquote><p><strong><code>docker rm  $(docker ps -qa)</code> 			一次性删除所有的容器</strong></p><p><strong><code>docker rm  -f $(docker ps -qa)</code> 		强制一次性删除所有的容器</strong></p><h3><a name='header-n514' class='md-header-anchor '></a>8 导入和导出容器</h3><p><strong>1 导出容器</strong></p><p>​	命令格式: <code>docker export CONTAINER [-o|--output[=&quot;&quot;]]</code> 或者 <code>docker export CONTAINER &gt; 输出路径</code></p><p>​	如下命令,先查看容器的ID,然后通过导出容器</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span> <span class="cm-attribute">-a</span> &nbsp; <span class="cm-comment"># 查看本地的容器</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">CONTAINER ID &nbsp; &nbsp; &nbsp;  IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</span></pre><pre class=""><span style="padding-right: 0.1px;">f78792b62156 &nbsp; &nbsp; &nbsp;  hello-world &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-string">"/hello"</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">7</span> seconds ago &nbsp; &nbsp; &nbsp; Exited (0) <span class="cm-number">6</span> seconds ago &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; flamboyant_bassi</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-keyword">export</span> f78792b62156 <span class="cm-attribute">-o</span> ~/temp/hello-world-bak  <span class="cm-comment"># 导出容器</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ ls</span> <span class="cm-attribute">-l</span> ~/temp/hello-world-bak  <span class="cm-comment"># 查看导出的容器文件</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-attribute">-rw-------</span>  <span class="cm-number">1</span> huangyunning  staff  <span class="cm-number">9728</span>  <span class="cm-number">7</span> <span class="cm-number">14</span> <span class="cm-number">00</span>:09 /Users/huangyunning/temp/hello-world-bak</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><p><strong>2 导入容器</strong></p><p>​	命令格式: </p><pre class='md-fences mock-cm' style='display:block;position:relative'>docker import [-c|--change[=[]]] [-m|--message=[MESSAGE]] file|URL|[REPOSITORY[:TAG]]</pre><blockquote><p><code>-c,--change=[]</code> 选项在导入的同时执行对容器进行修改的<code>Dockerfile</code>指令</p></blockquote><p>​	如下命令将刚才备份的容器导入:</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images &nbsp; <span class="cm-comment"># 查看已经存在的镜像</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/ubuntu &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  d355ed3537e9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">3</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">hello-world &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1815c82652c0 &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span>.84 kB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp;  latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> import ~/temp/hello-world-bak hw-bak <span class="cm-comment"># 导入备份的容器</span></span></pre><pre class=""><span style="padding-right: 0.1px;">sha256:67f88c3ec17f50f790b35e92982bd8077122ad099c1014d9308fb6bf5325c331</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">hw-bak &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  67f88c3ec17f &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> seconds ago &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span>.85 kB  <span class="cm-comment">#导入的镜像</span></span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/ubuntu &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  d355ed3537e9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">3</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">119</span> MB</span></pre><pre class=""><span style="padding-right: 0.1px;">hello-world &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  1815c82652c0 &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> weeks ago &nbsp; &nbsp; &nbsp; &nbsp; <span class="cm-number">1</span>.84 kB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/redis &nbsp;  latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  45c3ea2cecac &nbsp; &nbsp; &nbsp;  <span class="cm-number">5</span> months ago &nbsp; &nbsp; &nbsp;  <span class="cm-number">183</span> MB</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre><blockquote><p>​	<code>docker import</code> 和 <code>docker load</code> 十分相似, <code>docker load</code> 用于导入镜像存储文件到本地镜像库, 而 <code>docker import</code> 用于导入一个容器快照到本地镜像库</p><p>​	这两者的区别在于<strong>容器快照</strong>文件将丢失所有的历史记录和元数据信息(及仅保存容器当时的快照状态),而<strong>镜像存储文件</strong>将保存完整的记录,体积也更大.此外,从<strong>容器快照文件</strong>导入时可以重新指定标签和元数据信息等</p></blockquote><h2><a name='header-n538' class='md-header-anchor '></a>6 常用的Dokcer仓库</h2><p>​	常用的仓库中心:</p><p>​	<a href='https://c.163.com/hub#/m/search/?keyword=registry'>网易蜂巢</a></p><p>​	<a href='https://hub.tenxcloud.com/'>时速云镜像</a></p><p>​	<a href='https://hub.docker.com/explore/'>Docker Hub 公共镜像市场</a></p><h3><a name='header-n547' class='md-header-anchor '></a>1 搭建私有仓库</h3><p>​	<a href='https://docs.docker.com/registry/deploying/'>搭建私有仓库(官方文档)</a>	</p><p>​	在较新版本的仓库中,默认情况下,如果想让外部主机访问到必须配置SSL/TLS认证,具体操作步骤,请参考官方文档,这里我们只演示搭建一个非安全认证的本地仓库 , 步骤如下 : </p><p>​	<strong>1 下载官网提供的 registry 镜像</strong> </p><p>​	这里我们使用网易镜像源提供的链接进行拉取</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker pull hub.c.163.com/library/registry:latest</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p>​	<strong>2 配置关闭仓库的安全认证</strong></p><p>​	<a href='https://docs.docker.com/registry/insecure/#deploying-a-plain-http-registry'>自行配置证书或者关闭对仓库的安全性检查(官方文档)</a></p><p>​	编辑 <code>linux</code> 主机上的 <code>/etc/docker/daemon.json</code> 文件(没有时就创建一个) , 添加如下内容 :</p><pre class="md-fences md-end-block" lang="json"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">{</span></pre></div><pre class=""><span style="padding-right: 0.1px;">  <span class="cm-string cm-property">"insecure-registries"</span> : [<span class="cm-string">"192.168.71.128:5000"</span>]</span></pre><pre class=""><span style="padding-right: 0.1px;">}</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><blockquote><p><strong><code>192.168.71.128</code>   是宿主主机的域名或者 ip 地址 !!!</strong> <strong>这里需要根据自己主机的实际ip地址进行修改</strong></p></blockquote><p>​	或者直接使用下面的指令创建该配置文件</p><pre class='md-fences mock-cm' style='display:block;position:relative'>echo  \
\&quot;{
  \&quot;insecure-registries\&quot; : [\&quot;192.168.71.128:5000\&quot;]  \
}\&quot;  &gt; /etc/docker/daemon.json</pre><blockquote><p><strong><code>192.168.71.128</code>   是宿主主机的域名或者 ip 地址 !!!</strong> <strong>这里需要根据自己主机的实际ip地址进行修改</strong></p></blockquote><p>​	<strong>3 运行私有仓库 容器</strong></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">MacBook-Pro:<span class="cm-def">$ docker</span> run <span class="cm-attribute">-d</span> <span class="cm-attribute">-p</span> <span class="cm-number">5000</span>:5000 <span class="cm-attribute">-v</span> /Users/huangyunning/temp:/tmp/registry &nbsp; hub.c.163.com/library/registry:latest  <span class="cm-comment"># 下载并启动仓库</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">a08e4b9f3771d4127a25d37290c61636828fd2893cd5ad4429ad82f33807a55b</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">MacBook-Pro:<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span> <span class="cm-attribute">-a</span> &nbsp; &nbsp;  <span class="cm-comment"># 查看当前运行的容器</span></span></pre><pre class=""><span style="padding-right: 0.1px;">CONTAINER ID &nbsp; &nbsp; &nbsp;  IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  NAMES</span></pre><pre class=""><span style="padding-right: 0.1px;">a08e4b9f3771 &nbsp; &nbsp; &nbsp;  hub.c.163.com/library/registry:latest &nbsp; <span class="cm-string">"/entrypoint.sh /e..."</span> &nbsp; <span class="cm-number">10</span> seconds ago &nbsp; &nbsp;  Up <span class="cm-number">9</span> seconds &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span>.0.0.0:5000-&gt;5000/tcp &nbsp; xenodochial_saha</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 230px;"></div></div></div></pre><blockquote><p>默认情况下，会将仓库存放于容器的/tmp/registry目录下，这样如果容器被删除，则存放于容器中的镜像也会丢失，所以我们一般情况下会指定本地一个目录挂载到容器的<code>/tmp/registry</code>下</p><p><code>-p 5000:5000</code>	将主机的5000端口映射到容器的5000端口</p><p><code>-v  /Users/huangyunning/temp:/tmp/registry</code> 	将本地主机的目录 <code>/Users/huangyunning/temp</code>挂载到容器目录 <code>/tmp/registry</code>下</p></blockquote><p>​	<strong>4 将本地镜像推送至本地仓库</strong></p><p>​	要推送镜像到指定仓库,必须先标记镜像,使用如下命令</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker tag {镜像名或ID} <span class="cm-number">192</span>.168.71.128:5000/{你的用户名}/{标签名}</span></pre></div><pre class=""><span style="padding-right: 0.1px;">例如: docker tag hello-world <span class="cm-number">192</span>.168.71.128:5000/hello-world:latest</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p>​	推送 </p><pre class='md-fences mock-cm' style='display:block;position:relative'>docker push 192.168.71.128:5000/hello-world:latest</pre><h3><a name='header-n591' class='md-header-anchor '></a>2 推送镜像到网易蜂巢仓库</h3><p>​	这里直接给出官方文档链接,操作很简单 : <a href='http://support.c.163.com/md.html#!%E8%AE%A1%E7%AE%97%E6%9C%8D%E5%8A%A1/%E9%95%9C%E5%83%8F%E4%BB%93%E5%BA%93/%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97/%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F/%E6%8E%A8%E9%80%81%E6%9C%AC%E5%9C%B0%E9%95%9C%E5%83%8F.md'>推送本地镜像</a></p><h2><a name='header-n594' class='md-header-anchor '></a>7 Docker数据管理</h2><p>​	数据管理是指,在实际的生产环境中需要对数据进行持久化,或者字啊不同的容器之间进行数据的共享,这就需要涉及到数据的管理操作.</p><p>​	Docker中管理数据的方式主要由以下两种:</p><blockquote><p>1 数据卷( Data Volumes ) : 容器内的数据直接映射到本地的主机环境</p><p>2 数据卷容器( Data Volume Containers ) : 使用特定的容器维护数据卷 </p></blockquote><h3><a name='header-n604' class='md-header-anchor '></a>1 数据卷</h3><p>​	即可供容器使用的特殊目录,它将主机操作系统的目录直接映射进容器,类似Linux中的mount操作.数据卷有如下特点:</p><pre class='md-fences mock-cm' style='display:block;position:relative'>1 可以在容器之间进行共享和重用,使容器间的数据传递变得高效</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>2 数据卷内的数据修改时会立马生效,无论是在容器内还是本地进行操作</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>3 对数据卷的操作,不会影响镜像,解耦了应用和数据</pre><pre class='md-fences mock-cm' style='display:block;position:relative'>4 数据卷会一直存在,直到没有容器使用时,可以安全地卸载它</pre><ul><li><p><strong>挂载一个主机的目录到容器里作为数据卷</strong></p><p>​	我们在使用 <code>docker run</code> 命令运行一个容器时,可以通过添加 <code>-v</code> 选项来创建数据卷,如果要创建多个数据卷,就在命令行里重复添加 <code>-v</code> 选项.下面演示将本地计算机的 <code>/tmp</code> 目录映射到容器中的 <code>/itheima</code> 目录</p><pre class="md-fences md-end-block" lang="shell"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:tmp huangyunning<span class="cm-def">$ docker</span> images  <span class="cm-comment"># 查看当前主机的镜像</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">tomcat &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  2ba84e0bb1a9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> days ago &nbsp; &nbsp; &nbsp; &nbsp;  292MB</span></pre><pre class=""><span style="padding-right: 0.1px;">hub.c.163.com/library/tomcat &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  2ba84e0bb1a9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">4</span> days ago &nbsp; &nbsp; &nbsp; &nbsp;  292MB</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:tmp huangyunning<span class="cm-def">$ docker</span> run <span class="cm-attribute">-d</span> <span class="cm-attribute">--name</span> data-volumn-test <span class="cm-attribute">-P</span> <span class="cm-attribute">-v</span> /tmp:/itheima tomcat &nbsp; &nbsp; <span class="cm-comment"># 运行 tomcat 镜像 并将 /tmp 目录映射到容器里的 /itheima 目录作为数据卷</span></span></pre><pre class=""><span style="padding-right: 0.1px;">ae3216f067ec554fa6057b70ad143226ceb3e51f1e0bdb7aafad8025fafcdf56</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:tmp huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span> <span class="cm-attribute">-a</span> &nbsp;  <span class="cm-comment"># 查看当前运行的容器(应用)</span></span></pre><pre class=""><span style="padding-right: 0.1px;">CONTAINER ID &nbsp; &nbsp; &nbsp;  IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</span></pre><pre class=""><span style="padding-right: 0.1px;">ae3216f067ec &nbsp; &nbsp; &nbsp;  tomcat &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"catalina.sh run"</span> &nbsp; <span class="cm-number">7</span> seconds ago &nbsp; &nbsp; &nbsp; Up <span class="cm-number">7</span> seconds &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span>.0.0.0:32770-&gt;8080/tcp &nbsp; data-volumn-test</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 322px;"></div></div></div></pre><blockquote><p>命令行的选项参数说明如下:</p><p><code>-d</code>			以守护态运行,即在后台运行</p><p><code>--name data-volumn-test</code>		给当前启动的容器取名 : <code>data-volumn-test</code></p><p><code>-P</code>			自动映射本地主机的一个端口到容器内应用的端口,通过 <code>docker ps -a</code> 可以看到本地的 <code>32770</code> 端口			映射到了容器的 <code>8080</code> 端口 </p><p><code>-v /tmp:/itheima</code>	映射本地主机目录到容器的 <code>itheima</code> 目录</p></blockquote><p>​	这里我们可以通过 <code>docker exec</code> 指令进入容器内部查看我们挂载的数据卷是否成功</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:tmp huangyunning<span class="cm-def">$ docker</span> exec <span class="cm-attribute">-it</span> data-volumn-test <span class="cm-builtin">bash</span>  <span class="cm-comment"># 进入容器内部查看文件</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">root@ae3216f067ec:/usr/local/tomcat<span class="cm-comment"># cd / &nbsp; # 进入容器根目录</span></span></pre><pre class=""><span style="padding-right: 0.1px;">root@ae3216f067ec:/<span class="cm-comment"># ls<span class="cm-tab"> </span><span class="cm-tab">    </span># 查看文件</span></span></pre><pre class=""><span style="padding-right: 0.1px;">bin  boot  dev<span class="cm-tab">  </span>docker-java-home  etc  home  itheima  lib  lib32  lib64  libx32  media<span class="cm-tab">  </span>mnt  opt  proc<span class="cm-tab">  </span>root  run  sbin  srv  sys  tmp<span class="cm-tab">  </span>usr  var</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">root@ae3216f067ec:/<span class="cm-comment"># ls itheima/ &nbsp; &nbsp; # 查看数据卷 itheima 内的文件</span></span></pre><pre class=""><span style="padding-right: 0.1px;">a.txt  com.apple.launchd.PEi27KRmr5  com.apple.launchd.YtEqH08Y0Q  mysql.sock  mysql.sock.lock</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre><p>​	当然,我们还可以通过 <code>docker inspect 容器名|容器ID</code> 来查看容器的信息</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:tmp huangyunning<span class="cm-def">$ docker</span> inspect data-volumn-test  <span class="cm-comment"># 查看容器的信息</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">[</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; .... 省略一吨信息 ....</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-string">"Mounts"</span>: [</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  {</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"Type"</span>: <span class="cm-string">"bind"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"Source"</span>: <span class="cm-string">"/tmp"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"Destination"</span>: <span class="cm-string">"/itheima"</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"Mode"</span>: <span class="cm-string">""</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"RW"</span>: <span class="cm-atom">true</span>,</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"Propagation"</span>: <span class="cm-string">"rprivate"</span></span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  ],</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; <span class="cm-tab"> </span>.... 省略一吨信息 ....</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;"> &nbsp;  }</span></pre><pre class=""><span style="padding-right: 0.1px;">]</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 414px;"></div></div></div></pre><blockquote><p>可以看到 <code>Mounts</code> 节点下的信息即为我们挂载卷的信息, <code>RW</code>  可读可写,即 容器对该目录是可读可写的,如果要指定数据卷为只读则通过 <code>ro</code> 指定,如 <code>-v /tmp:/itheima:ro</code></p></blockquote></li><li><p><strong>挂载一个本地主机文件作为数据卷(不推荐)</strong></p><pre class='md-fences mock-cm' style='display:block;position:relative'>docker run -d --name data-volumn-test -P -v /tmp/itcast.txt:/itheima/itcast.txt tomcat</pre></li></ul><blockquote><p>这样当容器访问 <code>/itheima/itcast.txt</code> 文件时,实际上就是访问本地主机的 <code>/tmp/itcast.txt</code> 文件</p></blockquote><h3><a name='header-n649' class='md-header-anchor '></a>2 数据卷容器</h3><p>​	当用户需要在多个容器之间共享一些持续更新的数据时,最简单的方式就是使用数据卷容器.数据卷容器也是容器,但是它的目的是专门用来提供数据卷供其他容器挂载.</p><p>​	使用步骤如下:</p><pre class='md-fences mock-cm' style='display:block;position:relative'> 1 在启动容器1时,使用 `-v 数据卷容器名` 创建数据卷容器;</pre><pre class='md-fences mock-cm' style='display:block;position:relative'> 2 启动容器2时,使用 `--volumes-from 容器1`  从容器1挂载数据卷容器</pre><p>​	下面演示了创建两个容器 centos1,centos2 , 并在两个容器间共享数据卷容器 dbdata</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">$ docker</span> run <span class="cm-attribute">-it</span> <span class="cm-attribute">-v</span> /dbdata <span class="cm-attribute">--name</span> centos1 hub.c.163.com/library/centos <span class="cm-comment"># 运行容器centos1并创建数据卷容器dbdata</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">[root@fa6048b115b4 /]<span class="cm-comment"># ls</span></span></pre><pre class=""><span style="padding-right: 0.1px;">anaconda-post.log  bin  dbdata  dev  etc  home  lib  lib64  lost<span class="cm-operator">+</span>found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span></pre><pre class=""><span style="padding-right: 0.1px;">[root@fa6048b115b4 /]<span class="cm-comment"># exit &nbsp;  # 退出容器</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">exit</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">$ docker</span> run <span class="cm-attribute">-it</span> <span class="cm-attribute">--volumes-from</span> centos1 <span class="cm-attribute">--name</span> centos2 hub.c.163.com/library/centos  <span class="cm-comment"># 运行容器centos2,并从centos1挂载数据卷容器</span></span></pre><pre class=""><span style="padding-right: 0.1px;">[root@2e22a57ed87b /]<span class="cm-comment"># ls</span></span></pre><pre class=""><span style="padding-right: 0.1px;">anaconda-post.log  bin  dbdata  dev  etc  home  lib  lib64  lost<span class="cm-operator">+</span>found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span></pre><pre class=""><span style="padding-right: 0.1px;">[root@2e22a57ed87b /]<span class="cm-comment"># touch dbdata/itheima.txt &nbsp; # 在centos2中在数据卷容器内创建文件 itheima.txt</span></span></pre><pre class=""><span style="padding-right: 0.1px;">[root@2e22a57ed87b /]<span class="cm-comment"># exit</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-keyword">exit</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">$ docker</span> <span class="cm-builtin">start</span> centos1  <span class="cm-comment"># 启动centos1</span></span></pre><pre class=""><span style="padding-right: 0.1px;">centos1</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">$ docker</span> exec <span class="cm-attribute">-it</span> centos1 <span class="cm-builtin">bash</span>  <span class="cm-comment"># 进入centos1容器内部</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">[root@fa6048b115b4 /]<span class="cm-comment"># ls dbdata/ &nbsp; <span class="cm-tab">    </span># 查看数据卷容的内容,发现增加了文件 itheima.txt</span></span></pre><pre class=""><span style="padding-right: 0.1px;">itheima.txt</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 529px;"></div></div></div></pre><blockquote><p>可以多次使用 <code>--volumn-from</code> 参数来从多个容器挂载多个数据卷,还可以从其他已经挂载了容器卷的容器来挂载数据卷</p></blockquote><blockquote><p>使用 <code>--volumes-from</code> 参数所挂载数据卷的容器自身并不需要保持在运行状态!!!</p></blockquote><p>​	<strong>数据卷容器的删除:</strong> 如果删除了挂载的容器(如centos1,centos2),数据卷并不会被自动删除,如果要删除一个数据卷,必须在删除最后一个还挂载着它的容器之前的使用 <code>docker rm -v</code> 命令来指定同时删除关联的容器</p><h2><a name='header-n668' class='md-header-anchor '></a>8 端口映射和容器互联</h2><p>​	在实践中经常遇到多个组件容器共同协作的情况,这个时候就需要多个容器之间能够实现互相访问对方服务的情况.</p><p>​	除了网络访问外,Docker还提供了两个方便的功能来满足服务访问的的基本需求:</p><ul><li><strong>映射容器内应用的服务端口到本地主机</strong></li><li><strong>互联机制实现多个容器间通过容器名来快速访问</strong></li></ul><h3><a name='header-n680' class='md-header-anchor '></a>1 端口映射实现访问容器</h3><p>​	端口映射可以在容器启动时通过 <code>-p</code>或 <code>-P</code>参数来指定端口映射.当使用 <code>-P</code> 时,系统随机映射一个本地端口号到容器内部应用的端口号.使用 <code>-p</code> 时可以指定具体的本地主机端口号和容器的端口号 , 参数支持的格式如下:</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-attribute">-p</span> IP:HostPort:ContainerPort<span class="cm-tab">    </span><span class="cm-comment"># 映射本地主机端口号 HostPort 到 容器的端口号ContainerPort</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-attribute">-p</span> IP::ContainerPort<span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment"># 随机映射本地主机的一个端口号到容器的 ContainerPort 端口</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span><span class="cm-attribute">-p</span> HostPort:ContainerPort<span class="cm-tab">   </span><span class="cm-tab">    </span><span class="cm-comment"># 将本地主机的 HostPort 端口映射到容器的 ContainerPort 端口</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre><blockquote><p><code>IP</code> 必须是本地主机的ip地址,否则报错</p></blockquote><p>​	如下指令,在启动tomcat时,将本地主机的 <code>8888</code> 端口,映射到了容器的 <code>8080</code> 端口,这样一来就可以通过在本地主机的浏览器中输入 <code>localhost:8888</code> 来访问到容器内的 tomcat</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> run <span class="cm-attribute">-d</span> <span class="cm-attribute">-p</span> <span class="cm-number">8888</span>:8080 tomcat <span class="cm-comment"># 启动容器</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">81e406d33c050d38e3667a1ecdf9bb6aab024893a70f296424f8c7db490a0928</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span> <span class="cm-attribute">-a</span>  <span class="cm-comment"># 查看正在运行的容器</span></span></pre><pre class=""><span style="padding-right: 0.1px;">CONTAINER ID &nbsp; &nbsp; &nbsp;  IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  NAMES</span></pre><pre class=""><span style="padding-right: 0.1px;">81e406d33c05 &nbsp; &nbsp; &nbsp;  tomcat &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"catalina.sh run"</span> &nbsp; About a minute ago &nbsp; Up About a minute &nbsp; <span class="cm-number">0</span>.0.0.0:8888-&gt;8080/tcp &nbsp; relaxed_stonebraker</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> port 81e406d33c05 <span class="cm-comment"># 通过容器ID查看容器的端口映射</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">8080</span>/tcp <span class="cm-attribute">-</span>&gt; <span class="cm-number">0</span>.0.0.0:8888</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 253px;"></div></div></div></pre><blockquote><p><code>0.0.0.0</code> 代表所有的ip地址</p></blockquote><ul><li><p><strong>常用的与容器相关的指令还有如下:</strong></p><ul><li><strong>查看容器端口映射信息	 <code>docker port 容器ID</code></strong></li><li><strong>查看容器的具体配置信息 <code>docker inspect 容器IID</code></strong></li><li><strong>查看容器内运行的应用的运行日志  <code>docker logs 容器ID</code></strong></li></ul></li></ul><h3><a name='header-n707' class='md-header-anchor '></a>2 互联机制实现便携互访</h3><p>​	容器的互联 ( <code>link</code> )是一种让多个容器中应用进行快速交互的方式.它会在源容器和接收容器之间创建连接关系,接收容器可以通过容器名快速访问到源容器,而不用指定具体的<code>IP</code>地址 </p><p>​	<strong>1 设置容器名称</strong></p><p>​	容器互联是通过容器的名称 (<code>NAME</code>) 来连接的,所以我们需要为容器设置一个名字(<code>NAME</code>) . 当启动一个容器时,可以通过参数 <code>--name 容器名</code> 来设置容器的名字.</p><blockquote><p>1 事实上,创建容器时,系统会默认分配给容器一个名字,但实际中更倾向于自己去设置</p><p>2 容器的名称也是唯一</p></blockquote><p>​	<strong>2 容器互联</strong></p><p>​	容器互联通过 <code>--link</code> 参数实现,格式为 <code>--link name:alias</code> , 其中 <code>name</code> 是要连接的容器的名称 , <code>alias</code> 是这个连接的别名 . 下面演示如何通过互联机制实现容器的互相访问</p><blockquote><p>1 启动容器1 , 设置名称为 myTomcat</p><p>2 启动容器2 , 设置名称为 tomcat2 , 并设置互联至 myTomcat</p><p>3 验证两容器之间的互联情况</p></blockquote><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> images</span></pre></div><pre class=""><span style="padding-right: 0.1px;">REPOSITORY &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; TAG &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; IMAGE ID &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; SIZE</span></pre><pre class=""><span style="padding-right: 0.1px;">tomcat &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; latest &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  2ba84e0bb1a9 &nbsp; &nbsp; &nbsp;  <span class="cm-number">8</span> days ago &nbsp; &nbsp; &nbsp; &nbsp;  292MB</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> run <span class="cm-attribute">-d</span> <span class="cm-attribute">-P</span> <span class="cm-attribute">--name</span> myTomcat tomcat</span></pre><pre class=""><span style="padding-right: 0.1px;">023ee189c531f841009af66bb02c84660ca30a1665aa9e522a8b2131cdb12171</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> run <span class="cm-attribute">-d</span> <span class="cm-attribute">-P</span> <span class="cm-attribute">--name</span> tomcat2 <span class="cm-attribute">--link</span> myTomcat:link_myTomcat tomcat</span></pre><pre class=""><span style="padding-right: 0.1px;">1b5a018b58cda519a82b87625807f7058ae7cd70087cd7601231ea31fca50879</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> <span class="cm-builtin">ps</span> <span class="cm-attribute">-a</span>  <span class="cm-comment"># 查看容器的运行状态,确认都属于运行状态,否则无法通讯</span></span></pre><pre class=""><span style="padding-right: 0.1px;">CONTAINER ID &nbsp; &nbsp; &nbsp;  IMAGE &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; COMMAND &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; CREATED &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  STATUS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  PORTS &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; NAMES</span></pre><pre class=""><span style="padding-right: 0.1px;">1b5a018b58cd &nbsp; &nbsp; &nbsp;  tomcat &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"catalina.sh run"</span> &nbsp; <span class="cm-number">1</span> second ago &nbsp; &nbsp; &nbsp; &nbsp; Up <span class="cm-number">3</span> seconds &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span>.0.0.0:32770-&gt;8080/tcp &nbsp; tomcat2</span></pre><pre class=""><span style="padding-right: 0.1px;">023ee189c531 &nbsp; &nbsp; &nbsp;  tomcat &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-string">"catalina.sh run"</span> &nbsp; <span class="cm-number">2</span> minutes ago &nbsp; &nbsp; &nbsp;  Up <span class="cm-number">2</span> minutes &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-number">0</span>.0.0.0:32769-&gt;8080/tcp &nbsp; myTomcat</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 391px;"></div></div></div></pre><p>​	可以看到当前正在运行两个容器,名称分别为 tomcat2 , myTomcat ,此时我们可以通过命令 <code>docker exec -it tomcat2 bash</code> 进入容器 <code>tomcat2</code> 内部 , 并使用 <code>cat /etc/hosts</code> 查看连接信息</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">huangyunningdeMacBook-Pro:~ huangyunning<span class="cm-def">$ docker</span> exec <span class="cm-attribute">-it</span> tomcat2 <span class="cm-builtin">bash</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">root@1b5a018b58cd:/usr/local/tomcat<span class="cm-comment"># cat /etc/hosts </span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">127</span>.0.0.1<span class="cm-tab">   </span>localhost</span></pre><pre class=""><span style="padding-right: 0.1px;">::1<span class="cm-tab"> </span>localhost ip6-localhost ip6-loopback</span></pre><pre class=""><span style="padding-right: 0.1px;">fe00::0<span class="cm-tab"> </span>ip6-localnet</span></pre><pre class=""><span style="padding-right: 0.1px;">ff00::0<span class="cm-tab"> </span>ip6-mcastprefix</span></pre><pre class=""><span style="padding-right: 0.1px;">ff02::1<span class="cm-tab"> </span>ip6-allnodes</span></pre><pre class=""><span style="padding-right: 0.1px;">ff02::2<span class="cm-tab"> </span>ip6-allrouters</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">172</span>.17.0.2<span class="cm-tab">  </span>link_myTomcat 023ee189c531 myTomcat &nbsp;  <span class="cm-comment"># 互联的容器的IP地址</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">172</span>.17.0.3<span class="cm-tab">  </span>1b5a018b58cd<span class="cm-tab">    </span><span class="cm-comment"># 当前容器自身的IP地址 , 1b5a018b58cd 为容器自身的ID</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">root@1b5a018b58cd:/usr/local/tomcat<span class="cm-comment"># ping 172.17.0.2 &nbsp; # 通过 容器IP 地址通讯</span></span></pre><pre class=""><span style="padding-right: 0.1px;">PING <span class="cm-number">172</span>.17.0.2 (172.17.0.2): <span class="cm-number">56</span> data bytes</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">64</span> bytes from <span class="cm-number">172</span>.17.0.2: <span class="cm-def">icmp_seq</span><span class="cm-operator">=</span><span class="cm-number">0</span> <span class="cm-def">ttl</span><span class="cm-operator">=</span><span class="cm-number">64</span> <span class="cm-def">time</span><span class="cm-operator">=</span><span class="cm-number">0</span>.119 ms</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">64</span> bytes from <span class="cm-number">172</span>.17.0.2: <span class="cm-def">icmp_seq</span><span class="cm-operator">=</span><span class="cm-number">1</span> <span class="cm-def">ttl</span><span class="cm-operator">=</span><span class="cm-number">64</span> <span class="cm-def">time</span><span class="cm-operator">=</span><span class="cm-number">0</span>.077 ms</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">64</span> bytes from <span class="cm-number">172</span>.17.0.2: <span class="cm-def">icmp_seq</span><span class="cm-operator">=</span><span class="cm-number">2</span> <span class="cm-def">ttl</span><span class="cm-operator">=</span><span class="cm-number">64</span> <span class="cm-def">time</span><span class="cm-operator">=</span><span class="cm-number">0</span>.074 ms</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">64</span> bytes from <span class="cm-number">172</span>.17.0.2: <span class="cm-def">icmp_seq</span><span class="cm-operator">=</span><span class="cm-number">3</span> <span class="cm-def">ttl</span><span class="cm-operator">=</span><span class="cm-number">64</span> <span class="cm-def">time</span><span class="cm-operator">=</span><span class="cm-number">0</span>.074 ms</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">root@1b5a018b58cd:/usr/local/tomcat<span class="cm-comment"># ping myTomcat &nbsp;  # 通过 容器名称 通讯</span></span></pre><pre class=""><span style="padding-right: 0.1px;">PING link_myTomcat (172.17.0.2): <span class="cm-number">56</span> data bytes</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">64</span> bytes from <span class="cm-number">172</span>.17.0.2: <span class="cm-def">icmp_seq</span><span class="cm-operator">=</span><span class="cm-number">0</span> <span class="cm-def">ttl</span><span class="cm-operator">=</span><span class="cm-number">64</span> <span class="cm-def">time</span><span class="cm-operator">=</span><span class="cm-number">0</span>.157 ms</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">64</span> bytes from <span class="cm-number">172</span>.17.0.2: <span class="cm-def">icmp_seq</span><span class="cm-operator">=</span><span class="cm-number">1</span> <span class="cm-def">ttl</span><span class="cm-operator">=</span><span class="cm-number">64</span> <span class="cm-def">time</span><span class="cm-operator">=</span><span class="cm-number">0</span>.077 ms</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-number">64</span> bytes from <span class="cm-number">172</span>.17.0.2: <span class="cm-def">icmp_seq</span><span class="cm-operator">=</span><span class="cm-number">2</span> <span class="cm-def">ttl</span><span class="cm-operator">=</span><span class="cm-number">64</span> <span class="cm-def">time</span><span class="cm-operator">=</span><span class="cm-number">0</span>.077 ms</span></pre><pre class=""><span style="padding-right: 0.1px;">^X64 bytes from <span class="cm-number">172</span>.17.0.2: <span class="cm-def">icmp_seq</span><span class="cm-operator">=</span><span class="cm-number">3</span> <span class="cm-def">ttl</span><span class="cm-operator">=</span><span class="cm-number">64</span> <span class="cm-def">time</span><span class="cm-operator">=</span><span class="cm-number">0</span>.080 ms</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 575px;"></div></div></div></pre><p>​	也可以使用 <code>env</code> 指令查看当前容器的环境变量信息</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">root@1b5a018b58cd:/usr/local/tomcat<span class="cm-comment"># env</span></span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LD_LIBRARY_PATH</span><span class="cm-operator">=</span>/usr/local/tomcat/native-jni-lib</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LINK_MYTOMCAT_PORT_8080_TCP_PORT</span><span class="cm-operator">=</span>8080</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LINK_MYTOMCAT_ENV_no_proxy</span><span class="cm-operator">=</span>*.local, <span class="cm-number">169</span>.254/16</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">CATALINA_HOME</span><span class="cm-operator">=</span>/usr/local/tomcat</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LANG</span><span class="cm-operator">=</span>C.UTF-8</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">HOSTNAME</span><span class="cm-operator">=</span>1b5a018b58cd</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">OPENSSL_VERSION</span><span class="cm-operator">=</span><span class="cm-number">1</span>.1.0f-3</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">TOMCAT_VERSION</span><span class="cm-operator">=</span><span class="cm-number">8</span>.5.16</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># ... 省略一吨信息 ...</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">JAVA_HOME</span><span class="cm-operator">=</span>/docker-java-home/jre</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LINK_MYTOMCAT_ENV_TOMCAT_NATIVE_LIBDIR</span><span class="cm-operator">=</span>/usr/local/tomcat/native-jni-lib</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LINK_MYTOMCAT_ENV_TOMCAT_ASC_URL</span><span class="cm-operator">=</span>https://www.apache.org/dist/tomcat/tomcat-8/v8.5.16/bin/apache-tomcat-8.5.16.tar.gz.asc</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">JAVA_DEBIAN_VERSION</span><span class="cm-operator">=</span>8u131-b11-2</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">no_proxy</span><span class="cm-operator">=</span>*.local, <span class="cm-number">169</span>.254/16</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LINK_MYTOMCAT_ENV_TOMCAT_MAJOR</span><span class="cm-operator">=</span>8</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LINK_MYTOMCAT_PORT_8080_TCP_ADDR</span><span class="cm-operator">=</span><span class="cm-number">172</span>.17.0.2</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># ... 省略一吨信息 ...</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LINK_MYTOMCAT_PORT</span><span class="cm-operator">=</span>tcp://172.17.0.2:8080</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">PATH</span><span class="cm-operator">=</span>/usr/local/tomcat/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LINK_MYTOMCAT_ENV_JAVA_DEBIAN_VERSION</span><span class="cm-operator">=</span>8u131-b11-2</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">LINK_MYTOMCAT_PORT_8080_TCP</span><span class="cm-operator">=</span>tcp://172.17.0.2:8080</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">_</span><span class="cm-operator">=</span>/usr/bin/env</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 529px;"></div></div></div></pre><h2><a name='header-n737' class='md-header-anchor '></a>9 使用DockerFile创建镜像</h2><p>​		<code>Dockerfile</code> 是一个文本格式的配置文件 , 用户可以使用<code>Dockerfile</code> 来定制自己的镜像 . 相比由 <code>docker save</code> 指令生成的镜像 , 通过使用 <code>Dockerfile</code> 文件生成镜像更容易被使用者接受 , 因为它明确的表名了镜像是怎么生成 . 当我们需要定制自己额外的需求时，只需在 <code>Dockerfile</code>上添加或者修改指令，重新生成image即可，省去了敲命令的麻烦.</p><h3><a name='header-n740' class='md-header-anchor '></a>1 基本结构</h3><p>​		<code>Dockerfile</code> 由一行行命令语句组成 , 并且支持以 <code>#</code> 开头的注释行 , 并且忽略大小写. 一般来说 , Dockerfile 分为4个部分:</p><ul><li>基础镜像信息  <code>FROM</code></li><li>维护者信息    <code>MAINTAINER</code></li><li>镜像操作指令</li><li>容器启动时执行的指令 <code>CMD</code></li></ul><h3><a name='header-n756' class='md-header-anchor '></a>2 指令说明</h3><p>​	指令的一般格式为 : <code>INSTRUCTION  arguments</code>  <code>指令名  指令参数</code> , 常见指令如下表:</p><table><thead><tr><th style='text-align:left;' >指令</th><th style='text-align:left;' >说明</th></tr></thead><tbody><tr><td style='text-align:left;' >from</td><td style='text-align:left;' >指定创建的镜像的基础镜像(即在哪个镜像的基础上进行构建)</td></tr><tr><td style='text-align:left;' >maintainer</td><td style='text-align:left;' >指定维护者信息</td></tr><tr><td style='text-align:left;' >run</td><td style='text-align:left;' >运行指令</td></tr><tr><td style='text-align:left;' >cmd</td><td style='text-align:left;' >指定启动容器时默认执行的命令</td></tr><tr><td style='text-align:left;' >label</td><td style='text-align:left;' >指定生成镜像的元数据标签信息(版本号信息?)</td></tr><tr><td style='text-align:left;' >expose</td><td style='text-align:left;' >指定容器内应用监听的端口号</td></tr><tr><td style='text-align:left;' >env</td><td style='text-align:left;' >设置环境变量</td></tr><tr><td style='text-align:left;' >add</td><td style='text-align:left;' >复制<src>路径下的文件到指定<dest>路径</td></tr><tr><td style='text-align:left;' >copy</td><td style='text-align:left;' >复制本地主机的<src>路径下的内容到镜像中的<dest>路径</td></tr><tr><td style='text-align:left;' >entrypoint</td><td style='text-align:left;' >指定镜像的默认入口</td></tr><tr><td style='text-align:left;' >volumn</td><td style='text-align:left;' >创建数据卷的挂载点</td></tr><tr><td style='text-align:left;' >user</td><td style='text-align:left;' >指定容器运行时的用户名或者UID</td></tr><tr><td style='text-align:left;' >workdir</td><td style='text-align:left;' >配置工作目录</td></tr><tr><td style='text-align:left;' >arg</td><td style='text-align:left;' >指定镜像内使用的参数(例如版本号信息)</td></tr><tr><td style='text-align:left;' >onbuild</td><td style='text-align:left;' >配置当所创建的镜像作为其他镜像的基础镜像时,所执行的创建操作指令</td></tr><tr><td style='text-align:left;' >stopsignal</td><td style='text-align:left;' >容器退出的信号值</td></tr><tr><td style='text-align:left;' >healthcheck</td><td style='text-align:left;' >如何进行健康检查</td></tr><tr><td style='text-align:left;' >shell</td><td style='text-align:left;' >指定使用shell时的默认shell类型 , 如 sh , bash , ksh ...</td></tr></tbody></table><ul><li><p><code>from</code> 指定基于哪个镜像构建</p><p>​	必须指定且需要在<code>Dockerfile</code>其他指令的前面。后续的指令都依赖于该指令指定的镜像。<code>FROM</code>指令指定的基础基础镜像如果本地不存在,会从远端仓库下载 . 格式 : <code>from 镜像名</code> 或者 <code>from 镜像名:版本标签</code></p></li><li><p><code>maintainer</code> 指定创建者信息</p><p>​	格式 : <code>maintainer 作者信息</code> , 如 <code>MAINTAINER fmi110@itcast.cn</code></p></li><li><p><code>run</code> 安装软件用</p><p>​	格式 : <code>run  COMMAND</code> 或者 <code>run [&quot;要执行的程序名&quot;,&quot;参数1&quot;,&quot;参数2&quot; ...]</code></p><p>​	前者默认是在 <code>shell</code> 终端运行命令 , 即 <code>/bash/sh -c</code> , 或者则使用 <code>exec</code> 执行,不启动 <code>shell</code> 环境 , 当命令较长时,可以使用 <code>\</code> 来换行</p><blockquote><p><code>Linux</code> 中 <code>exec</code> 命令用于调用并执行指令的命令。<code>exec</code>命令通常用在shell脚本程序中，可以调用其他的命令。如果在当前终端中使用命令，则当指定的命令执行完毕后会立即退出终端。</p><p>例如, <code>exec -c echo itheima.com</code>  跟在终端输入 <code>echo itheima.com</code> 输出效果相同 </p></blockquote></li><li><p><code>cmd</code>  设置启动容器时执行的默认命令</p><p>​	每个 <code>Dockerfile</code> 中只能由一条 <code>CMD</code> 命令 , 如果存在多条 , 最后一条被执行 . 此外,如果用户在启动容器时,手动指定了运行的命令(作为 <code>run</code> 的参数) ,则会覆盖 <code>CMD</code> 指定的命令</p><p>​	该命令由3种格式:</p><blockquote><p>​	CMD  [&quot;程序名&quot;,&quot;参数1&quot;,&quot;参数2&quot;] 	使用 <code>exec</code> 执行</p><p>​	CMD  命令  参数1  参数2 			在 <code>/bin/sh</code> 中执行 ,提供给需要交互的应用</p><p>​	CMD [&quot;参数1&quot;,&quot;参数2&quot;]				提供给 <code>entrypoint</code> (镜像的默认入口命令)的默认参数</p></blockquote></li></ul><ul><li><p><code>env</code> 指定环境变量</p><p>​	格式 : <code>env  环境变量名   变量的值</code></p><p>​	使用该指令设置环境变量后 后续的<code>RUN</code>命令都可以使用该变量，container启动后，可以通过<code>docker inspect</code>查看这个环境变量，也可以在启动容器时指定环境变量 ,如 <code>docker run --env key=value</code> 来设置或修改环境变量。
​	假如你安装了JAVA程序，需要设置<code>JAVA_HOME</code>，那么可以在<code>Dockerfile</code>中这样写：</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">ENV JAVA_HOME /path/to/java/directory</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre></li><li><p><code>add</code> 复制文件</p><p>​	格式 : <code>add  &lt;src&gt;  &lt;dest&gt;</code> </p><p>​	<code>&lt;src&gt;</code> 可以是<code>Dockerfile</code> 所在目录的一个相对路径,也可以是一个 <code>url</code> , 还可以是一个 <code>tar</code> 文件 (<code>tar</code> 文件会自动解压到 <code>&lt;dest&gt;</code> 路径下)</p><p>​	<code>&lt;dest&gt;</code> 可以是镜像内的绝对路径,也可以是相对与工作目录( <code>workdir</code> ) 的相对路径</p><p>​	此外,路径支持正则表达式 , 例如 : <code>add  *.c  /code/</code> 复制当前目录下以 <code>.c</code> 结尾的文件到 /code 目录下</p><blockquote><p>所有拷贝到 <code>&lt;dest&gt;</code> 中的文件和文件夹权限为0755，uid和gid为0；如果是一个目录，那么会将该目录下的所有文件添加到 <code>&lt;dest&gt;</code> 中，不包括源目录本身；</p></blockquote></li><li><p><code>copy</code> 复制文件</p><p>​	格式 : <code>copy  &lt;src&gt;  &lt;dest&gt;</code> </p><p>​	功能跟 <code>add</code> 基本一致,但是copy 复制 tar 文件时,文件不会自动解压 </p></li><li><p><code>entryponit</code>  镜像的默认入口命令</p><p>​	该入口命令会在启动容器时作为根命令执行,所有传入值作为该命令的参数 . 支持的格式如下:</p><blockquote><p>​	ENTRYPOINT  [&quot;程序名&quot;,&quot;参数1&quot;,&quot;参数2&quot;] 	使用 <code>exec</code> 执行</p><p>​	ENTRYPOINT  命令  参数1  参数2 			在 <code>/bin/sh</code> 中执行 ,提供给需要交互的应用</p><p>​	ENTRYPOINT  [&quot;参数1&quot;,&quot;参数2&quot;]				提供给 <code>entrypoint</code> (镜像的默认入口命令)的默认参数</p></blockquote></li></ul><ul><li><p><code>USER</code> </p><p>​	指定运行容器时的用户或UID , 默认为 <code>root</code> 用户</p><p>​	格式 : <code>user 用户名</code></p></li></ul><ul><li><p><code>volumn</code> 创建数据卷挂载点</p><p>​	格式 : <code>volumn [&quot;挂载路径&quot;]</code> ,如 <code>VOLUMN [&quot;/data&quot;]</code></p><p>​	可以从本地主机或者其他容器挂载数据卷,一般用来存放数据库和需要保存的数据等.</p><blockquote><p>容器使用的是AUFS，这种文件系统不能持久化数据，当容器关闭后，所有的更改都会丢失。当容器中的应用有持久化数据的需求时可以在<code>Dockerfile</code>中使用该指令</p></blockquote></li><li><p><code>workdir</code> 指定工作目录</p><p>​	为后续的 <code>RUN</code> <code>CMD</code> <code>ENTRYPOINT</code> 命令指定工作目录 , 格式 : <code>WORKDIR  /path/to/workdir</code></p><p>​	例如,如下指令指定在 <code>/p1/p2</code> 目录下,执行 <code>vim a.txt</code> 命令</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>WORKDIR /p1/p2 RUN <span class="cm-builtin">vim</span> a.txt</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p>​	可以使用多个 <code>WORKDIR</code> 指令 ,或许指令如果参数是相对路径 ,则会基于之前的命令确定路径,例如</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>WORKDIR  /a</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>WORKDIR  b</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>WORKDIR  c</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-tab">    </span>RUN pwd</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></pre><p>​	则最终输出的路径为 <code>/a/b/c</code></p></li></ul><ul><li><p><code>expose</code> 指定容器内服务监听的端口</p><p>​	格式 : <code>EXPOSE  port1  port2  ...</code></p><p>​	例如 : <code>expose 22 80 8443</code> 指定容器监听端口 <code>22</code> <code>80</code> <code>8443</code></p><blockquote><p><code>expose</code> 指令只是声明作用 ,并不会自动完成端口映射. 若要实现本地主机到容器的端口映射 ,还需要在启动容器时 使用 <code>-P</code> 或 <code>-p</code> 参数来实现映射</p></blockquote></li></ul><h3><a name='header-n940' class='md-header-anchor '></a>3 构建镜像案例</h3><p>​	下面提供几个镜像的 <code>Dockerfile</code>文件</p><ul><li><p>网易蜂巢 centos6.7-tools</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">FROM hub.c.163.com/public/centos:6.7</span></pre></div><pre class=""><span style="padding-right: 0.1px;">RUN yum clean all</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN yum install <span class="cm-attribute">-y</span> yum-plugin-ovl || <span class="cm-atom">true</span></span></pre><pre class=""><span style="padding-right: 0.1px;">RUN yum install <span class="cm-attribute">-y</span> <span class="cm-builtin">vim</span> tar <span class="cm-builtin">wget</span> <span class="cm-builtin">curl</span> rsync bzip2 iptables tcpdump less <span class="cm-builtin">telnet</span> net-tools lsof sysstat cronie python-setuptools</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN yum clean all</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN easy_install supervisor</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN <span class="cm-builtin">cp</span> <span class="cm-attribute">-f</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></pre><pre class=""><span style="padding-right: 0.1px;">EXPOSE 22</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN <span class="cm-builtin">mkdir</span> <span class="cm-attribute">-p</span> /etc/supervisor/conf.d/</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN /usr/bin/echo_supervisord_conf &gt; /etc/supervisord.conf</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN <span class="cm-builtin">echo</span> [include] &gt;&gt; /etc/supervisord.conf</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN <span class="cm-builtin">echo</span> <span class="cm-string">'files = /etc/supervisor/conf.d/*.conf'</span> &gt;&gt; /etc/supervisord.conf</span></pre><pre class=""><span style="padding-right: 0.1px;">COPY sshd.conf /etc/supervisor/conf.d/sshd.conf</span></pre><pre class=""><span style="padding-right: 0.1px;">CMD [<span class="cm-string">"/usr/bin/supervisord"</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 345px;"></div></div></div></pre></li></ul><ul><li><p>网易蜂巢 centos6.7</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">FROM centos:6.7-base</span></pre></div><pre class=""><span style="padding-right: 0.1px;">MAINTAINER netease</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">RUN <span class="cm-builtin">cp</span> <span class="cm-attribute">-f</span> /usr/share/zoneinfo/Asia/Shanghai /etc/localtime</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN yum install <span class="cm-attribute">-y</span> openssh-server &amp;&amp; yum clean all</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN ssh-keygen <span class="cm-attribute">-t</span> rsa <span class="cm-attribute">-f</span> /etc/ssh/ssh_host_rsa_key</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN ssh-keygen <span class="cm-attribute">-t</span> dsa <span class="cm-attribute">-f</span> /etc/ssh/ssh_host_dsa_key</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN <span class="cm-builtin">echo</span> <span class="cm-string">"RSAAuthentication yes"</span> &gt;&gt; /etc/ssh/sshd_config</span></pre><pre class=""><span style="padding-right: 0.1px;">RUN <span class="cm-builtin">echo</span> <span class="cm-string">"PubkeyAuthentication yes"</span> &gt;&gt; /etc/ssh/sshd_config &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">EXPOSE <span class="cm-number">22</span> &nbsp;  </span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">CMD [<span class="cm-string">"/usr/sbin/sshd"</span>, <span class="cm-string">"-D"</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></pre></li></ul><h2><a name='header-n953' class='md-header-anchor '></a>10 Web应用-Tomcat</h2><h3><a name='header-n954' class='md-header-anchor '></a>1 使用官方镜像</h3><p></p><h3><a name='header-n957' class='md-header-anchor '></a>2 使用 <code>dockerfile</code> 构建自己的 Tomcat 镜像</h3><ul><li><a href='http://download.oracle.com/otn-pub/java/jdk/8u141-b15/336fa29ff2bb4ef291e347e091f7f4a7/jdk-8u141-linux-x64.tar.gz?AuthParam=1501057512_8761f191988c183c1b29f1e77da8a420'>从oracle下载jdk</a></li><li>从apache官网下载tomcat</li><li>创建文件夹 /dockerfile_test/ , 并将 jdk 和 tomcat 解压到路径下 (后续的操作全部在该目录下进行)</li><li>在 /dockerfile_test/ 下创建 Dockerfile , 文件内容如下</li><li>使用命令 <code>docker build -t tomcat:7.0.79-jdk8 .</code> 构建镜像 , <code>.</code> 表示使用当前目录中的 <code>Dockerfile</code> </li><li>创建和测试镜像</li></ul><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">from hub.c.163.com/public/centos:6.7-tools</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># 设置创建者的信息</span></span></pre><pre class=""><span style="padding-right: 0.1px;">MAINTAINER fmi110(fmi110@itheima.com)</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># 设置 tomcat 和 jdk 的环境变量</span></span></pre><pre class=""><span style="padding-right: 0.1px;">ENV  CATALINA_HOME  /tomcat</span></pre><pre class=""><span style="padding-right: 0.1px;">ENV  JAVA_HOME /jdk</span></pre><pre class=""><span style="padding-right: 0.1px;">ENV  PATH <span class="cm-def">$CATALINA_HOME</span>/bin:<span class="cm-def">$JAVA_HOME</span>:<span class="cm-def">$PATH</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># 复制tomcat 和 jdk 文件到镜像中</span></span></pre><pre class=""><span style="padding-right: 0.1px;">ADD apache-tomcat-7.0.79 /tomcat</span></pre><pre class=""><span style="padding-right: 0.1px;">ADD jdk1.8.0_141 /jdk</span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-comment"># 添加管理员账户</span></span></pre><pre class=""><span style="padding-right: 0.1px;">RUN <span class="cm-builtin">echo</span>  \&lt;?xml <span class="cm-def">version</span><span class="cm-operator">=</span>\<span class="cm-string">'1.0\' encoding=\'utf-8\'?\&gt;  \</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-string">\&lt;tomcat-users\&gt;  \</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-string">\&lt;role rolename=\"manager-gui\"/\&gt;  \</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-string">\&lt;user roles=\"manager-gui\" username=\"admin\" password=\"admin\" /\&gt;  \</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-string">\&lt;/tomcat-users\&gt;  &gt; $CATALINA_HOME/conf/tomcat-users.xml</span></span></pre><pre class=""><span style="padding-right: 0.1px;"><span>​</span></span></pre><pre class=""><span style="padding-right: 0.1px;">EXPOSE 8080</span></pre><pre class=""><span style="padding-right: 0.1px;">CMD [<span class="cm-string">"catalina.sh"</span>, <span class="cm-string">"run"</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 529px;"></div></div></div></pre><h2><a name='header-n978' class='md-header-anchor '></a>11 数据库应用</h2><h3><a name='header-n979' class='md-header-anchor '></a>1 MySQL</h3><p>​	从网易蜂巢镜像库,可以找到 mysql 对应的官网镜像 : <a href='https://c.163.com/hub#/m/repository/?repoId=2955'>mysql</a></p><p>​	下面以 <code>mysql 5.7.18</code> 版本为例,说明 mysql 的使用 , 演示案例时 ,本地主机的 ip 地址为 : <code>192.168.71.128</code></p><p><strong>1 拉取镜像</strong></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker pull hub.c.163.com/library/mysql:5.7.18</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><strong>2 启动一个 MySQL Server 实例</strong></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker run <span class="cm-attribute">--name</span> hi-mysql <span class="cm-attribute">-e</span> <span class="cm-def">MYSQL_ROOT_PASSWORD</span><span class="cm-operator">=</span>root <span class="cm-attribute">-d</span> <span class="cm-attribute">-p</span> <span class="cm-number">3307</span>:3306 hub.c.163.com/library/mysql:5.7.18</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><blockquote><p><code>--name hi-mysql</code> 				指定容器的名称叫 <code>hi-mysql</code></p><p><code>-e MYSQL_ROOT_PASSWORD=root</code>		设置 root 用户的密码为 <code>root</code></p><p><code>-d</code>								设置服务在后台运行</p><p><code>-p 3307:3306</code>					将本地主机的 <code>3307</code> 端口映射到容器的 <code>3306</code> 端口 , <strong>此时在本地主机可以使用下面的命令行可以访问容器内的mysql服	务 <code>mysql -h 192.168.71.128 -P3307 -uroot -proot</code></strong></p></blockquote><p><strong>3 访问容器shell终端(进入容器) , 查看容器的日志输出</strong></p><p>​	使用如下命令进入容器内部: <code>docker exec -it hi-mysql bash</code>  , 其中 <code>hi-mysql</code> 是启动容器时,给容器指定的名称</p><p>​	使用如下命令可以查看容器的日志输出 : <code>docker logs hi-mysql</code> , 其中 <code>hi-mysql</code> 是启动容器时,给容器指定的名称</p><p><strong>4 使用用户自定的配置文件</strong></p><p>​	MySQL启动时默认加载的是 <code>/etc/mysql/my.cnf</code> 文件 , 而该文件会自动引入( include )  <code>/etc/mysql/conf.d</code> 目录下的 <code>.cnf</code> 结尾的文件 . 这些文件中定义的变量的优先级高于 <code>/etc/mysql/my.cnf</code> 中定义的变量 . 因此如果用户想自定义配置时,可以创建对应的 .cnf 文件 , 然后放置到 <code>/etc/mysql/conf.d</code> 目录下 . 或者通过数据卷的方式将本地主机放有 .cnf 文件的目录挂载到容器的 <code>/etc/mysql/conf.d</code> 中 .</p><p>​	这里需要注意 , 当本地主机运行了 SELinux 时 , 通过数据卷挂载的方式可能会因为权限的问题,而导致失败 ,此时需要使用下面的命令修改本地主机的文件权限</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">chcon <span class="cm-attribute">-Rt</span> svirt_sandbox_file_t /my/custom</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><blockquote><p>chcon命令：修改对象（文件）的安全上下文。比如：用户：角色：类型：安全级别</p><p>-R 		递归修改</p><p>-t		修改安全上下文类型的配置</p><p><code>/my/custom</code>		本地主机上的目录</p></blockquote><p>​	然后使用如下命令启动容器</p><pre class='md-fences mock-cm' style='display:block;position:relative'>docker run --name hi-mysql2 -v /my/custom:/etc/mysql/conf.d -e 	MYSQL_ROOT_PASSWORD=root -d -p 3308:3306 hub.c.163.com/library/mysql:5.7.18</pre><blockquote><p><code>-v /my/custom:/etc/mysql/conf.d</code>	将本地主机的 <code>/my/custom</code> 目录挂载到容器的 <code>/etc/mysql/conf.d</code> 目录下</p></blockquote><p>​	如下是解决 mysql 中文乱码的配置文件 <code>encode.cnf</code> , 将其放在 <code>/my/custom</code> 目录下 ,然后重启 <code>hi-mysql2</code> 容器,即可解决中文乱码问题</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">[client]</span></pre></div><pre class=""><span style="padding-right: 0.1px;">default-character-set <span class="cm-operator">=</span> utf8mb4</span></pre><pre class=""><span style="padding-right: 0.1px;">[mysql]</span></pre><pre class=""><span style="padding-right: 0.1px;">default-character-set <span class="cm-operator">=</span> utf8mb4</span></pre><pre class=""><span style="padding-right: 0.1px;">[mysqld]</span></pre><pre class=""><span style="padding-right: 0.1px;">character-set-client-handshake <span class="cm-operator">=</span> FALSE</span></pre><pre class=""><span style="padding-right: 0.1px;">character-set-server <span class="cm-operator">=</span> utf8mb4</span></pre><pre class=""><span style="padding-right: 0.1px;">collation-server <span class="cm-operator">=</span> utf8mb4_unicode_ci</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-def">init_connect</span><span class="cm-operator">=</span><span class="cm-string">'SET NAMES utf8mb4'</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 207px;"></div></div></div></pre><p>​	使用命令 <code>docker exec -it hi-mysql2 bash</code> 进入容器 , 然后 <code>mysql -uroot -proot</code> 登录 mysql , 使用如下命令查看数据库的字符集配置信息如下:</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">mysql&gt; show variables like <span class="cm-string">'%char%'</span>;</span></pre></div><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">+</span><span class="cm-attribute">--------------------------</span><span class="cm-operator">+</span><span class="cm-attribute">----------------------------</span><span class="cm-operator">+</span></span></pre><pre class=""><span style="padding-right: 0.1px;">| Variable_name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  | Value &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">+</span><span class="cm-attribute">--------------------------</span><span class="cm-operator">+</span><span class="cm-attribute">----------------------------</span><span class="cm-operator">+</span></span></pre><pre class=""><span style="padding-right: 0.1px;">| character_set_client &nbsp; &nbsp; | utf8mb4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |</span></pre><pre class=""><span style="padding-right: 0.1px;">| character_set_connection | utf8mb4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |</span></pre><pre class=""><span style="padding-right: 0.1px;">| character_set_database &nbsp; | utf8mb4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |</span></pre><pre class=""><span style="padding-right: 0.1px;">| character_set_filesystem | binary &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span></pre><pre class=""><span style="padding-right: 0.1px;">| character_set_results &nbsp;  | utf8mb4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |</span></pre><pre class=""><span style="padding-right: 0.1px;">| character_set_server &nbsp; &nbsp; | utf8mb4 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  |</span></pre><pre class=""><span style="padding-right: 0.1px;">| character_set_system &nbsp; &nbsp; | utf8 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |</span></pre><pre class=""><span style="padding-right: 0.1px;">| character_sets_dir &nbsp; &nbsp; &nbsp; | /usr/share/mysql/charsets/ |</span></pre><pre class=""><span style="padding-right: 0.1px;"><span class="cm-operator">+</span><span class="cm-attribute">--------------------------</span><span class="cm-operator">+</span><span class="cm-attribute">----------------------------</span><span class="cm-operator">+</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 299px;"></div></div></div></pre><blockquote><p>字符集 <code>utf8mb4</code>  是 <code>mysql 5.5.3</code> 版本以后引入的字符集 , 目的是为了支持 <code>emoji</code> 表情符号 . </p></blockquote><p><strong>5 脱离 cnf 文件进行配置</strong></p><p>​	很多的配置选项可以通过标签 (flags) 传递到 mysqld 进程 , 这样用户可以脱离 cnf 配置文件 , 对容器进行弹性的配置 . 比如,要修改默认的字符编码 ,将所有表格的编码集修改为 utf8mb4 时,可以使用如下命令 :</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker run <span class="cm-attribute">--name</span> hi-mysql3 <span class="cm-attribute">-e</span> <span class="cm-def">MYSQL_ROOT_PASSWORD</span><span class="cm-operator">=</span>root <span class="cm-attribute">-d</span> <span class="cm-attribute">-P</span> hub.c.163.com/library/mysql:5.7.18 <span class="cm-attribute">--character-set-server</span><span class="cm-operator">=</span>utf8mb4 <span class="cm-attribute">--collation-server</span><span class="cm-operator">=</span>utf8mb4_unicode_ci</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 46px;"></div></div></div></pre><p>​	如果要查看可用选项的完整列表 , 可执行如下命令</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker run <span class="cm-attribute">-it</span> <span class="cm-attribute">--rm</span> hub.c.163.com/library/mysql:5.7.18 <span class="cm-attribute">--verbose</span> <span class="cm-attribute">--help</span></span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><h3><a name='header-n1044' class='md-header-anchor '></a>2 Redis</h3><p>​	参考文档地址 : <a href='https://c.163.com/hub#/m/repository/?repoId=2973'>redis</a></p><p><strong>1 拉取镜像</strong></p><pre class='md-fences mock-cm' style='display:block;position:relative'>docker pull hub.c.163.com/library/redis:4.0.1-alpine</pre><p><strong>2 给镜像设置一个 tag</strong></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker tag hub.c.163.com/library/redis:4.0.1 redis:4.0.1</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><p><strong>3 运行一个redis实例</strong></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">docker run <span class="cm-attribute">-d</span> <span class="cm-attribute">--name</span> hi-redis <span class="cm-attribute">-p</span> <span class="cm-number">6379</span>:6379 redis:4.0.1</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 23px;"></div></div></div></pre><blockquote><p>docker 官网的redis 镜像默认是暴露 6379 端口的</p></blockquote><p><strong>4 运行redis实例 , 并开启持久化存储</strong></p><pre class='md-fences mock-cm' style='display:block;position:relative'>docker run --name hi-redis2 -d redis:4.0.1 redis-server --appendonly yes</pre><blockquote><p>开启持久化后,数据默认存储在容器的 <code>/data</code> 目录下 , 通常会结合数据卷或数据卷容器来使用 , 例如 <code>--volumes-from some-volume-container</code>  或 </p><p><code>-v /docker/host/dir:/data</code></p></blockquote><p><strong>5 互联机制连接 redis</strong></p><pre class='md-fences mock-cm' style='display:block;position:relative'>docker run --name some-app --link hi-redis:redis -d application-that-uses-redis</pre><p><strong>6 通过 <code>redis-cli</code> 访问 redis</strong></p><pre class='md-fences mock-cm' style='display:block;position:relative'>docker run -it --rm  --link hi-redis:redisxx redis:4.0.1 redis-cli -h redisxx -p 6379</pre><blockquote><p><code>--rm</code> 							指定容器停止时,即删除容器</p><p><code>--link hi-redis:redisxx</code>			通过互联机制连接到 <code>hi-redis</code> 容器 , 并取别名为 <code>redisxx</code></p><p><code>redis-cli -h redisxx -p 6379</code>	通过端口 <code>6379</code> 访问名为 <code>redisxx</code> 的主机的 <code>redis</code> </p></blockquote><p><strong>7 使用自定义的配置文件 <code>redis.conf</code></strong></p><ul><li><p>通过 Dockerfile 在构建镜像时,添加 <code>redis.conf</code></p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">FROM redis</span></pre></div><pre class=""><span style="padding-right: 0.1px;">COPY redis.conf /usr/local/etc/redis/redis.conf</span></pre><pre class=""><span style="padding-right: 0.1px;">CMD [ \<span class="cm-string">"redis-server\", \"/usr/local/etc/redis/redis.conf\" ]</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre></li></ul><ul><li><p>使用数据卷挂载的方式添加 <code>redis.conf</code></p><pre class='md-fences mock-cm' style='display:block;position:relative'>docker run -v /myredis/conf/redis.conf:/usr/local/etc/redis/redis.conf --name hi-redis3 redis-server /usr/local/etc/redis/redis.conf</pre><blockquote><p><code>/myredis/conf/</code> 	本地主机的目录,目录下放置了配置文件 <code>redis.conf</code></p></blockquote></li></ul><blockquote><p> 通过挂载主机文件的方式就可以省去编写 Dockerfile 的时间了</p></blockquote><p></p><h2><a name='header-n1100' class='md-header-anchor '></a>12 Linux知识补充</h2><h3><a name='header-n1101' class='md-header-anchor '></a><code>yum</code> 指令</h3><p>​	<code>yum</code>命令是在<code>Fedora</code>和<code>RedHat</code>以及<code>SUSE</code>中基于<code>rpm</code>的软件包管理器，它可以使系统管理人员交互和自动化地更细与管理RPM软件包，能够从指定的服务器自动下载<code>RPM</code>包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软体包，无须繁琐地一次次下载、安装。 <code>yum</code> 提供了查找、安装、删除某一个、一组甚至全部软件包的命令，而且命令简洁而又好记.</p><p>​	语法 : <code>yum  [选项]  (参数)</code></p><ul><li><p>安装</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">yum install<span class="cm-tab"> </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span> <span class="cm-comment">#全部安装 </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">yum install package1<span class="cm-tab">    </span> <span class="cm-comment">#安装指定的安装包package1 </span></span></pre><pre class=""><span style="padding-right: 0.1px;">yum groupinsall group1 <span class="cm-tab"> </span> <span class="cm-comment">#安装程序组group1n</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre></li><li><p>查找和显示</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">yum info package1 <span class="cm-tab">  </span><span class="cm-tab">    </span><span class="cm-comment">#显示安装包信息package1 </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">yum list <span class="cm-tab">   </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">#显示所有已经安装和可以安装的程序包 </span></span></pre><pre class=""><span style="padding-right: 0.1px;">yum list package1 <span class="cm-tab">  </span><span class="cm-tab">    </span><span class="cm-comment">#显示指定程序包安装情况package1 </span></span></pre><pre class=""><span style="padding-right: 0.1px;">yum groupinfo group1 <span class="cm-tab">   </span><span class="cm-comment">#显示程序组group1信息</span></span></pre><pre class=""><span style="padding-right: 0.1px;">yum search string <span class="cm-tab">  </span><span class="cm-tab">    </span><span class="cm-comment">#根据关键字string查找安装包yu</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre></li><li><p>更新和升级</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">yum update <span class="cm-tab"> </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">#全部更新 </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">yum update package1 <span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">#更新指定程序包package1 </span></span></pre><pre class=""><span style="padding-right: 0.1px;">yum check-update <span class="cm-tab">   </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">#检查可更新的程序 </span></span></pre><pre class=""><span style="padding-right: 0.1px;">yum upgrade package1 <span class="cm-tab">   </span><span class="cm-tab">    </span><span class="cm-comment">#升级指定程序包package1 </span></span></pre><pre class=""><span style="padding-right: 0.1px;">yum groupupdate group1 <span class="cm-tab"> </span><span class="cm-tab">    </span><span class="cm-comment">#升级程序组group1</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre></li><li><p>删除程序</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">yum remove|erase package1 <span class="cm-tab">  </span><span class="cm-comment">#删除程序包package1 </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">yum groupremove group1 <span class="cm-tab"> </span><span class="cm-tab">    </span><span class="cm-comment">#删除程序组group1 </span></span></pre><pre class=""><span style="padding-right: 0.1px;">yum deplist package1 <span class="cm-tab">   </span><span class="cm-tab">    </span><span class="cm-comment">#查看程序package1依赖情况</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre></li><li><p>清楚缓存</p><pre class="md-fences md-end-block" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 0px; left: 4px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">yum clean packages <span class="cm-tab"> </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">#清除缓存目录下的软件包 </span></span></pre></div><pre class=""><span style="padding-right: 0.1px;">yum clean headers <span class="cm-tab">  </span><span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-comment">#清除缓存目录下的 headers </span></span></pre><pre class=""><span style="padding-right: 0.1px;">yum clean oldheaders <span class="cm-tab">   </span><span class="cm-tab">    </span><span class="cm-comment">#清除缓存目录下旧的 headers</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 69px;"></div></div></div></pre></li></ul><h3><a name='header-n1127' class='md-header-anchor '></a>Linux下输出重定向 <code>&gt;</code>  <code>&gt;&gt;</code> 的区别</h3><p>1 <code>&gt;</code>是定向输出到文件，如果文件不存在，就创建文件；如果文件存在，就将其清空；一般我们备份清理日志文件的时候，就是这种方法：先备份日志，再用<code>&gt;</code>，将日志文件清空（文件大小变成0字节）；</p><p>​2 <code>&gt;&gt;</code> 这个是将输出内容追加到目标文件中。如果文件不存在，就创建文件；如果文件存在，则将新的内容追加到那个文件的末尾，该文件中的原有内容不受影响。</p><h3><a name='header-n1132' class='md-header-anchor '></a><code>Linux</code> 命令控制符 <code>&amp;&amp;</code> 和 <code>||</code></h3><p><code>command1 &amp;&amp; command2</code>	  	如果<code>command1</code> 执行成功,则执行 <code>command2</code> ,否则不执行</p><p> <code>command1 || command2</code>		如果<code>command1</code> 执行失败,则执行 <code>command2</code></p><h3><a name='header-n1137' class='md-header-anchor '></a><code>CentOS</code> 的 <code>rpm</code> 指令</h3><p>​	RPM 的全称为Redhat Package Manager ，是由Redhat 公司提出的，用于管理Linux 下软件包的软件。Linux 安装时，除了几个核心模块以外，其余几乎所有的模块均通过RPM 完成安装。常用命令如下:</p><pre class="md-fences md-end-block md-focus" lang="sh"> <div class="CodeMirror cm-s-inner CodeMirror-wrap "><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 92px; left: 377.641px;"></div><div class="CodeMirror-scrollbar-filler"></div><div class="CodeMirror-gutter-filler"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; min-height: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure">AخA</div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code"><div class="" style="position: relative;"><pre class=""><span style="padding-right: 0.1px;">rpm -ivh example.rpm  <span class="cm-tab">  </span><span class="cm-tab">    </span>#安装 example.rpm 包并在安装过程中显示正在安装的文件信息及安装进度；</span></pre></div><pre class=""><span style="padding-right: 0.1px;">rpm -qa <span class="cm-tab">    </span><span class="cm-tab">    </span><span class="cm-tab">    </span> &nbsp; <span class="cm-tab"> </span><span class="cm-tab">    </span>#查询所有已经安装的包以下两个附加命令用于查询安装包的信息；</span></pre><pre class=""><span style="padding-right: 0.1px;">rpm -qa | grep tomcat <span class="cm-tab">  </span><span class="cm-tab">    </span>#查看 tomcat 是否被安装；</span></pre><pre class=""><span style="padding-right: 0.1px;">rpm -qlf /bin/df <span class="cm-tab">   </span> &nbsp;  <span class="cm-tab">    </span>#查看/bin/df 文件所在安装包中的各个文件分别被安装到哪个目录下</span></pre><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><pre class=""><span style="padding-right: 0.1px;">rpm -e tomcat <span class="cm-tab">  </span><span class="cm-tab">    </span> &nbsp;  <span class="cm-tab">    </span>#卸载 tomcat4 软件包</span></pre></div></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 0px;"></div><div class="CodeMirror-gutters" style="display: none; height: 115px;"></div></div></div></pre></div>
</body>
</html>